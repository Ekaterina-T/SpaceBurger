{"version":3,"sources":["components/modal-overlay/modal-overlay.module.css","pages/order-info.module.css","reportWebVitals.ts","services/actionTypes.ts","services/ingredients/reducer.ts","services/cart/reducer.ts","services/user/reducer.ts","utils/constants.ts","services/orders/reducer.ts","services/rootReducer.ts","utils/cookie.ts","services/middleware/socketMiddleware.ts","services/store.ts","services/types/index.ts","components/app-header/nav-item/nav-item.tsx","components/app-header/nav-list/nav-list.tsx","components/app-header/app-header.tsx","components/route-auth-users/route-auth-users.tsx","components/route-unauth-users/route-unauth-users.tsx","components/burger-ingredients/ingredient-group/ingredient-group.tsx","services/cart/actions.ts","components/burger-ingredients/ingredient/ingredient.tsx","components/burger-ingredients/tab-menu/tab-menu.tsx","components/modal-overlay/modal-overlay.tsx","components/modal/modal.tsx","components/ingredient-details/ingredient-details.tsx","components/burger-ingredients/burger-ingredients.tsx","components/order-details/order-details-icon.tsx","components/order-details/order-details.tsx","components/burger-constructor/burger-constructor-total/burger-constructor-total.tsx","components/burger-constructor/burger-constructor-item/burger-constructor-item.tsx","components/burger-constructor/burger-constructor.tsx","pages/main.tsx","components/app-form/app-form.tsx","utils/token.ts","services/user/actions.ts","pages/login.tsx","pages/register.tsx","pages/forgot-password.tsx","pages/reset-password.tsx","components/profile-settings/profile-settings.tsx","components/price/price.tsx","components/ingredient-icon-round/ingredient-icon-round.tsx","utils/vocabulary/ru.ts","utils/date-formatter/date-formatter.ts","components/utils/order.ts","components/order-card/order-card.tsx","components/feed-list/feed-list.tsx","pages/profile.tsx","pages/not-found.tsx","components/feed-overview/orderid-list/order-id-list.tsx","components/feed-overview/feed-info/feed-info.tsx","components/feed-overview/feed-overview.tsx","pages/feed.tsx","pages/order-info.tsx","components/app/app.tsx","services/ingredients/actions.ts","index.tsx","components/order-card/order-card.module.css","components/ingredient-details/ingredient-details.module.css","components/feed-overview/feed-overview.module.css","components/burger-ingredients/ingredient/ingredient.module.css","components/order-details/order-details.module.css","components/app-header/nav-item/nav-item.module.css","components/burger-constructor/burger-constructor.module.css","components/feed-overview/orderid-list/orderid-list.module.css","pages/index.module.css","components/burger-ingredients/burger-ingredients.module.css","components/burger-ingredients/ingredient-group/ingredient-group.module.css","components/burger-constructor/burger-constructor-total/burger-constructor-total.module.css","components/app-form/app-form.module.css","components/feed-list/feed-list.module.css","pages/profile.module.css","pages/feed.module.css","components/app-header/app-header.module.css","components/app-header/nav-list/nav-list.module.css","components/modal/modal.module.css","components/burger-constructor/burger-constructor-item/burger-constructor-item.module.css","components/profile-settings/profile-settings.module.css","components/price/price.module.css","components/ingredient-icon-round/ingredient-icon-round.module.css","components/feed-overview/feed-info/feed-info.module.css"],"names":["module","exports","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ActionTypes","GET_INGREDIENTS_REQUEST","GET_INGREDIENTS_SUCCESS","GET_INGREDIENTS_FAILED","SET_ACTIVE_INGREDIENT","SHOW_INGREDIENT_DETAILS","UPDATE_CART","CREATE_NEW_ORDER_REQUEST","CREATE_NEW_ORDER_SUCCESS","CREATE_NEW_ORDER_FAILED","SHOW_ORDER_DETAILS","CLOSE_ORDER","SORT_FILLINGS_ORDER","REGISTER_REQUEST","REGISTER_SUCCESS","REGISTER_FAILED","LOGIN_REQUEST","LOGIN_SUCCESS","LOGIN_FAILED","LOGOUT_REQUEST","LOGOUT_SUCCESS","LOGOUT_FAILED","PASSWORD_RESET_CODE_REQUEST","PASSWORD_RESET_CODE_SUCCESS","PASSWORD_RESET_CODE_FAILED","PASSWORD_RESET_REQUEST","PASSWORD_RESET_SUCCESS","PASSWORD_RESET_FAILED","USER_REFRESH_SUCCESS","wsAllOrders","wsInit","onOpen","onError","onClose","onGetMessage","wsSendMessage","wsUserOrders","initialState","ingredientsLoad","ingredientsLoadSuccess","ingredientsLoadFailed","items","showIngredientDetails","activeIngredient","bun","fillings","createOrderInProgress","createOrderSuccess","createOrderFailed","showOrderDetails","orderDetails","registerRequest","registerSuccess","registerFailed","loginRequest","loginSuccess","loginFailed","logoutRequest","logoutSuccess","logoutFailed","passwordResetCodeRequest","passwordResetCodeSuccess","passwordResetCodeFailed","passwordResetRequest","passwordResetSuccess","passwordResetFailed","refreshSuccess","accessToken","accessTokenTimeStamp","refreshToken","ingredientGroups","type","name","domain","authEndpoints","registerUrl","authUrl","logoutUrl","tokenUrl","userUrl","socketType","allOrders","personalOrders","accessTokenName","refreshTokenName","socket","wsConnected","error","messages","data","state","action","socketName","payload","JSON","parse","rootReducer","combineReducers","ingredients","value","cart","updatedCart","user","timeStamp","email","orders","getCookie","matches","document","cookie","match","RegExp","replace","decodeURIComponent","getCookieValue","indexOf","split","setCookie","props","exp","expires","d","Date","setTime","getTime","toUTCString","updatedCookie","encodeURIComponent","propName","propValue","enhancer","window","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","compose","applyMiddleware","thunk","store","next","dispatch","WebSocket","ws","createSocket","wsActions","onopen","event","onerror","onmessage","onclose","message","send","stringify","createStore","useAppDispatch","useDispatch","useAppSelector","useSelector","NavItem","id","title","icon","cssClass","subitems","to","className","styles","nav_item","isActive","isExact","nav_link","activeClassName","children","link_text","setDefault","NavList","main_nav","nested_nav","map","item","AppHeader","menuItems","header","nav","RouteForAuthorizedUsers","rest","render","location","pathname","target","getNextPage","result","RouteForUnauthorizedUsers","IngredientGroup","group","addIngredientToCart","ingredientID","getState","prevCart","newIngredient","filter","_id","ingredient","key","reduce","res","currentKey","Number","join","assignKeyToIngredient","Ingredient","openModal","useDrag","dragRef","ingredientCount","React","useMemo","count","length","image","price","card","onClick","e","nodeName","ref","size","src","alt","price_num","add_btn","stopPropagation","TabMenu","burgerIngredientsEl","currentTab","updateCurrentTab","scrollIntoSection","tabValue","section","current","querySelector","scrollIntoView","behavior","style","display","ingredientGroup","active","ModalOverlay","backdrop","Modal","useState","activeBeforeModal","setActiveBeforeModal","modalControls","setModalControls","modalComponent","useRef","useEffect","activeElement","focus","modalRoot","ReactDOM","createPortal","modal","tabIndex","onKeyDown","code","shiftKey","preventDefault","addTabTrap","IngredientDetails","useParams","activeIngredientFromStore","find","calories","proteins","fat","carbohydrates","image_large","nutritionItems","details_section","details_header","details_title","nutrition_info","nutrition_item","nutrition_title","nutrition_val","BurgerIngredients","useLocation","history","useHistory","setCurrentTab","getIngredientsFrom","background","ingredient_groups","onScroll","scrollableArea","scrollableAreaTop","getBoundingClientRect","y","visibleGroup","Array","prototype","slice","call","querySelectorAll","sectionIndex","allSections","getAttribute","goBack","OrderDetailsIcon","width","height","viewBox","fill","xmlns","fillRule","clipRule","fillOpacity","cx","cy","r","gradientUnits","gradientTransform","stopColor","stopOpacity","offset","OrderDetails","notes_main","success","notes_sec","info_section","orderId","order","number","orderId_note","common_notes_main","common_notes_sec","BurgerConstructorTotal","calcTotal","acc","filling","constructor_total","button_wrapper","fetch","method","headers","body","ok","json","Promise","reject","catch","info_important","BurgerConstructorItem","index","text","thumbnail","isLocked","collect","monitor","isDragging","drag","useDrop","accept","hover","dragIndex","hoverIndex","oldItemIndex","newItemIndex","hoverBoundingRect","hoverMiddleY","bottom","top","hoverClientY","getClientOffset","newFillings","itemToMove","splice","getItem","drop","removeIngredient","ingredientKey","removedIngredientIndex","findIndex","updatedFillings","removeIngredientFromCart","opacity","burgerIngredient","cursor","dragIcon","handleClose","BurgerConstructor","dropTarget","fillingsItems","cartHasItems","constructor_area","main_area","scrollable_area","emptyConstructor","MainPage","DndProvider","backend","HTML5Backend","AppForm","onSubmit","additionalStyles","getFormStyles","defaultStyles","concat","serverRequest","url","options","console","log","getProfileSettings","updateProfileSettings","updatedUserSettings","authorization","setToken","localStorage","setItem","logout","Error","removeItem","runServerRequest","requestFunction","requestFunctionParams","status","LoginPage","password","credentials","setCredentials","onInputChange","prevVal","input","onChange","button","helpRedirect","link","RegisterPage","registerInfo","setRegisterInfo","push","elem","placeholder","ForgotPasswordPage","setEmail","requestPasswordResetCode","ResetPasswordPage","verificationToken","resetData","setResetData","PASSWORD_PLACEHOLDER","ProfileSettings","setUser","updateField","profileStyles","buttonsArea","updatedFields","prevState","buttonSeparator","Price","IngredientIconRound","image_mobile","customStyle","ingredientContainer","ingredientImg","translationsRU","DateFormatter","getDate","dateValue","date","minutes","getMinutes","getHours","getTZ","offsetInHours","getTimezoneOffset","Math","abs","getDaysDiff","now","cleanDate","setHours","cleanNow","diffInDays","getMonth","getFullYear","getRelativeFormat","formatOrderNumber","num","String","leadingZeroCount","prefix","OrderCard","updatedAt","ingredientsData","numOfIngredientsInOrder","images","left","zIndex","hiddenIngredientsReplacement","sum","topInfo","timestamp","bottomInfo","FeedList","owner","showOrderInfo","setShowOrderInfo","activeOrder","setActiveOrder","useRouteMatch","fallbackMsg","orders__profile","ProfilePage","profileMenuItems","label","infoText","onClickHandler","currentMenuItem","profileNav","exact","profileNavItem","profileInfo","path","NotFoundPage","OrderIDList","orderList","listTitle","listItem","FeedInfo","FeedOverview","total","totalToday","readyOrders","inProgressOrders","overview","content","contentRow","contentRow__item","FeedPage","page","contentArea","orderStatusTranslations","done","inprogress","cancelled","OrderInfoPage","undefined","cardInModal","contentTitle","ingredientsInOrder","ingredientCounts","counts","hasOwnProperty","ingredientInOrder","position","ingredientInOrderName","getOrderContent","footer","App","statusText","StrictMode","basename","getElementById"],"mappings":"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","file":"static/js/main.7543cfb5.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"backdrop\":\"modal-overlay_backdrop__23Z-A\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"card\":\"order-info_card__3ag5A\",\"cardInModal\":\"order-info_cardInModal__3Niw8 order-info_card__3ag5A p-10\",\"id\":\"order-info_id__18GLv text text_type_main-default\",\"title\":\"order-info_title__31rIg text text_type_main-medium pt-10 pb-3\",\"status\":\"order-info_status__2hGDB text text_type_main-default\",\"status_done\":\"order-info_status_done__1feBs order-info_status__2hGDB text text_type_main-default\",\"status_cancelled\":\"order-info_status_cancelled__18k6U order-info_status__2hGDB text text_type_main-default\",\"content\":\"order-info_content__1NnUA pt-15 pb-10\",\"contentTitle\":\"order-info_contentTitle__3j9GY text text_type_main-medium pb-6\",\"ingredients\":\"order-info_ingredients__10LkP pr-6\",\"ingredientInOrder\":\"order-info_ingredientInOrder__uPL88 pb-4\",\"ingredientInOrderName\":\"order-info_ingredientInOrderName__2UDt6 text text_type_main-default pl-4 pr-4\",\"footer\":\"order-info_footer__CXlz6\",\"timestamp\":\"order-info_timestamp__3_gc0 text text_type_main-default\"};","import { ReportHandler } from 'web-vitals';\r\n\r\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\r\n  if (onPerfEntry && onPerfEntry instanceof Function) {\r\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\r\n      getCLS(onPerfEntry);\r\n      getFID(onPerfEntry);\r\n      getFCP(onPerfEntry);\r\n      getLCP(onPerfEntry);\r\n      getTTFB(onPerfEntry);\r\n    });\r\n  }\r\n};\r\n\r\nexport default reportWebVitals;\r\n","export type TWSAllOrders = {\r\n    wsInit: 'WS_CONNECTION_ALL_ORDERS_START';\r\n    onOpen: 'WS_CONNECTION_ALL_ORDERS_SUCCESS';\r\n    onError: 'WS_CONNECTION_ALL_ORDERS_ERROR';\r\n    onClose: 'WS_CONNECTION_ALL_ORDERS_CLOSED';\r\n    onGetMessage: 'WS_ALL_ORDERS_GET_MESSAGE';\r\n    wsSendMessage: 'WS_ALL_ORDERS_SEND_MESSAGE';\r\n}\r\n\r\nexport type TWSUserOrders = {\r\n    wsInit: 'WS_CONNECTION_USER_ORDERS_START';\r\n    onOpen: 'WS_CONNECTION_USER_ORDERS_SUCCESS';\r\n    onError: 'WS_CONNECTION_USER_ORDERS_ERROR';\r\n    onClose: 'WS_CONNECTION_USER_ORDERS_CLOSED';\r\n    onGetMessage: 'WS_USER_ORDERS_GET_MESSAGE';\r\n    wsSendMessage: 'WS_USER_ORDERS_SEND_MESSAGE';\r\n};\r\n\r\nexport type TActionTypes = {\r\n\r\n    //saved all actions in one file - easy to import and use\r\n    //however not sure it's good, I incline ActionTypes should be split by stores as well\r\n    GET_INGREDIENTS_REQUEST: 'GET_INGREDIENTS_REQUEST';\r\n    GET_INGREDIENTS_SUCCESS: 'GET_INGREDIENTS_SUCCESS';\r\n    GET_INGREDIENTS_FAILED: 'GET_INGREDIENTS_FAILED';\r\n    SET_ACTIVE_INGREDIENT: 'SET_ACTIVE_INGREDIENT';\r\n    SHOW_INGREDIENT_DETAILS: 'SHOW_INGREDIENT_DETAILS';\r\n\r\n    UPDATE_CART: 'UPDATE_CART';\r\n    \r\n    CREATE_NEW_ORDER_REQUEST: 'CREATE_NEW_ORDER_REQUEST';\r\n    CREATE_NEW_ORDER_SUCCESS: 'CREATE_NEW_ORDER_SUCCESS';\r\n    CREATE_NEW_ORDER_FAILED: 'CREATE_NEW_ORDER_FAILED';\r\n    SHOW_ORDER_DETAILS: 'SHOW_ORDER_DETAILS';\r\n    CLOSE_ORDER: 'CLOSE_ORDER';    \r\n    SORT_FILLINGS_ORDER: 'SORT_FILLINGS_ORDER';\r\n\r\n    REGISTER_REQUEST: 'REGISTER_REQUEST';\r\n    REGISTER_SUCCESS: 'REGISTER_SUCCESS';\r\n    REGISTER_FAILED: 'REGISTER_FAILED';\r\n\r\n    LOGIN_REQUEST: 'LOGIN_REQUEST';\r\n    LOGIN_SUCCESS: 'LOGIN_SUCCESS';\r\n    LOGIN_FAILED: 'LOGIN_FAILED';\r\n\r\n    LOGOUT_REQUEST: 'LOGOUT_REQUEST';\r\n    LOGOUT_SUCCESS: 'LOGOUT_SUCCESS';\r\n    LOGOUT_FAILED: 'LOGOUT_FAILED';\r\n\r\n    PASSWORD_RESET_CODE_REQUEST: 'PASSWORD_RESET_CODE_REQUEST';\r\n    PASSWORD_RESET_CODE_SUCCESS: 'PASSWORD_RESET_CODE_SUCCESS';\r\n    PASSWORD_RESET_CODE_FAILED: 'PASSWORD_RESET_CODE_FAILED';\r\n\r\n    PASSWORD_RESET_REQUEST: 'PASSWORD_RESET_REQUEST';\r\n    PASSWORD_RESET_SUCCESS: 'PASSWORD_RESET_SUCCESS';\r\n    PASSWORD_RESET_FAILED: 'PASSWORD_RESET_FAILED';\r\n\r\n    USER_REFRESH_SUCCESS: 'USER_REFRESH_SUCCESS';\r\n\r\n    wsAllOrders: TWSAllOrders;\r\n    wsUserOrders: TWSUserOrders;\r\n\r\n};\r\n\r\nexport const ActionTypes : TActionTypes = {\r\n\r\n    //saved all actions in one file - easy to import and use\r\n    //however not sure it's good, I incline ActionTypes should be split by stores as well\r\n    GET_INGREDIENTS_REQUEST: 'GET_INGREDIENTS_REQUEST',\r\n    GET_INGREDIENTS_SUCCESS: 'GET_INGREDIENTS_SUCCESS',\r\n    GET_INGREDIENTS_FAILED: 'GET_INGREDIENTS_FAILED',\r\n    SET_ACTIVE_INGREDIENT: 'SET_ACTIVE_INGREDIENT',\r\n    SHOW_INGREDIENT_DETAILS: 'SHOW_INGREDIENT_DETAILS',\r\n\r\n    UPDATE_CART: 'UPDATE_CART',    \r\n    CREATE_NEW_ORDER_REQUEST: 'CREATE_NEW_ORDER_REQUEST',\r\n    CREATE_NEW_ORDER_SUCCESS: 'CREATE_NEW_ORDER_SUCCESS',\r\n    CREATE_NEW_ORDER_FAILED: 'CREATE_NEW_ORDER_FAILED',\r\n    SHOW_ORDER_DETAILS: 'SHOW_ORDER_DETAILS',\r\n    CLOSE_ORDER: 'CLOSE_ORDER',\r\n\r\n    SORT_FILLINGS_ORDER: 'SORT_FILLINGS_ORDER',\r\n\r\n    REGISTER_REQUEST: 'REGISTER_REQUEST',\r\n    REGISTER_SUCCESS: 'REGISTER_SUCCESS',\r\n    REGISTER_FAILED: 'REGISTER_FAILED',\r\n\r\n    LOGIN_REQUEST: 'LOGIN_REQUEST',\r\n    LOGIN_SUCCESS: 'LOGIN_SUCCESS',\r\n    LOGIN_FAILED: 'LOGIN_FAILED',\r\n\r\n    LOGOUT_REQUEST: 'LOGOUT_REQUEST',\r\n    LOGOUT_SUCCESS: 'LOGOUT_SUCCESS',\r\n    LOGOUT_FAILED: 'LOGOUT_FAILED',\r\n\r\n    PASSWORD_RESET_CODE_REQUEST: 'PASSWORD_RESET_CODE_REQUEST',\r\n    PASSWORD_RESET_CODE_SUCCESS: 'PASSWORD_RESET_CODE_SUCCESS',\r\n    PASSWORD_RESET_CODE_FAILED: 'PASSWORD_RESET_CODE_FAILED',\r\n\r\n    PASSWORD_RESET_REQUEST: 'PASSWORD_RESET_REQUEST',\r\n    PASSWORD_RESET_SUCCESS: 'PASSWORD_RESET_SUCCESS',\r\n    PASSWORD_RESET_FAILED: 'PASSWORD_RESET_FAILED',\r\n\r\n    USER_REFRESH_SUCCESS: 'USER_REFRESH_SUCCESS',\r\n\r\n    wsAllOrders: {\r\n        wsInit: 'WS_CONNECTION_ALL_ORDERS_START',\r\n        onOpen: 'WS_CONNECTION_ALL_ORDERS_SUCCESS',\r\n        onError: 'WS_CONNECTION_ALL_ORDERS_ERROR',\r\n        onClose: 'WS_CONNECTION_ALL_ORDERS_CLOSED',\r\n        onGetMessage: 'WS_ALL_ORDERS_GET_MESSAGE',\r\n        wsSendMessage: 'WS_ALL_ORDERS_SEND_MESSAGE'\r\n    },\r\n\r\n    wsUserOrders: {\r\n        wsInit: 'WS_CONNECTION_USER_ORDERS_START',\r\n        onOpen: 'WS_CONNECTION_USER_ORDERS_SUCCESS',\r\n        onError: 'WS_CONNECTION_USER_ORDERS_ERROR',\r\n        onClose: 'WS_CONNECTION_USER_ORDERS_CLOSED',\r\n        onGetMessage: 'WS_USER_ORDERS_GET_MESSAGE',\r\n        wsSendMessage: 'WS_USER_ORDERS_SEND_MESSAGE'\r\n    }\r\n\r\n};\r\n","import {ActionTypes} from '../actionTypes';\r\nimport { TIngredientActions } from './actions';\r\nimport { TIngredient } from '../types';\r\n\r\nexport type TIngredientState = {\r\n    ingredientsLoad: boolean,\r\n    ingredientsLoadSuccess: boolean,\r\n    ingredientsLoadFailed: boolean,\r\n    items: Array<TIngredient>,\r\n\r\n    showIngredientDetails: boolean,\r\n    activeIngredient: TIngredient | null,\r\n}\r\n\r\nconst initialState: TIngredientState = {\r\n    ingredientsLoad: false,\r\n    ingredientsLoadSuccess: false,\r\n    ingredientsLoadFailed: false,\r\n    items: [],\r\n\r\n    showIngredientDetails: false,\r\n    activeIngredient: null,\r\n}\r\n\r\nexport const ingredients = (state = initialState, action: TIngredientActions): TIngredientState => {\r\n\r\n    switch (action.type) {\r\n\r\n        case  ActionTypes.GET_INGREDIENTS_REQUEST:\r\n            return {\r\n                ...state, \r\n                ingredientsLoad: true\r\n            };\r\n\r\n        case  ActionTypes.GET_INGREDIENTS_SUCCESS:\r\n            return {\r\n                ...state, \r\n                ingredientsLoad: false, \r\n                ingredientsLoadSuccess: true, \r\n                items: action.data\r\n            };\r\n\r\n        case  ActionTypes.GET_INGREDIENTS_FAILED:\r\n            return  {\r\n                ...state, \r\n                ingredientsLoad: false,\r\n                ingredientsLoadFailed: true\r\n            };\r\n            \r\n        case  ActionTypes.SHOW_INGREDIENT_DETAILS:\r\n            return  {\r\n                ...state, \r\n                showIngredientDetails: action.value\r\n            };\r\n\r\n        case  ActionTypes.SET_ACTIVE_INGREDIENT:\r\n            return {\r\n                ...state,\r\n                activeIngredient: action.value\r\n            };\r\n\r\n        default: return state;\r\n    }\r\n}","import {ActionTypes} from '../actionTypes';\r\nimport { TIngredient, TOrderDetails } from '../types';\r\nimport { TCartActions } from './actions';\r\n\r\nexport type TCartState = {\r\n    bun: TIngredient | null,\r\n    fillings: Array<TIngredient>,\r\n    createOrderInProgress?: boolean;\r\n    createOrderSuccess?: boolean;\r\n    createOrderFailed?: boolean;\r\n    showOrderDetails?: boolean;\r\n    orderDetails?: TOrderDetails | null;\r\n}\r\n\r\nconst initialState: TCartState = {\r\n    bun: null, \r\n    fillings: [],\r\n    createOrderInProgress: false,\r\n    createOrderSuccess: false,\r\n    createOrderFailed: false,\r\n    showOrderDetails: false,\r\n    orderDetails: null\r\n}\r\n\r\nexport const cart = (state = initialState, action: TCartActions): TCartState => {\r\n    switch (action.type) {\r\n          \r\n        case  ActionTypes.UPDATE_CART:\r\n            return {\r\n                ...state,\r\n                bun: action.updatedCart.bun,\r\n                fillings: action.updatedCart.fillings\r\n            };\r\n\r\n        case  ActionTypes.CREATE_NEW_ORDER_REQUEST:\r\n            return {\r\n                ...state,\r\n                createOrderInProgress: true\r\n            };\r\n\r\n        case  ActionTypes.CREATE_NEW_ORDER_SUCCESS:\r\n            return {\r\n                ...state,\r\n                createOrderInProgress: false,\r\n                createOrderSuccess: true,\r\n                orderDetails: action.orderDetails,\r\n                showOrderDetails: true\r\n            };\r\n        \r\n        case  ActionTypes.CREATE_NEW_ORDER_FAILED:\r\n            return {\r\n                ...state,\r\n                createOrderInProgress: false,\r\n                createOrderFailed: true\r\n            };\r\n        \r\n        case  ActionTypes.CLOSE_ORDER: \r\n            return {\r\n                ...state,\r\n                createOrderSuccess: false,\r\n                showOrderDetails: false,\r\n                orderDetails: null,\r\n                bun: null, \r\n                fillings: []\r\n            };\r\n        \r\n        default: return state;\r\n    }\r\n}","import {ActionTypes} from '../actionTypes';\r\nimport { TUserActions } from './actions';\r\n\r\n\r\nexport type TUserState = {\r\n    name?: string,\r\n    email?: string,\r\n    \r\n    registerRequest: boolean,\r\n    registerSuccess: boolean,\r\n    registerFailed: boolean,\r\n\r\n    loginRequest: boolean,\r\n    loginSuccess: boolean,\r\n    loginFailed: boolean,\r\n\r\n    logoutRequest: boolean,\r\n    logoutSuccess: boolean,\r\n    logoutFailed: boolean,\r\n\r\n    passwordResetCodeRequest: boolean,\r\n    passwordResetCodeSuccess: boolean,\r\n    passwordResetCodeFailed: boolean,\r\n\r\n    passwordResetRequest: boolean,\r\n    passwordResetSuccess: boolean,\r\n    passwordResetFailed: boolean,\r\n    refreshSuccess: boolean,\r\n\r\n    accessToken: string | null,\r\n    accessTokenTimeStamp: string | null,\r\n    refreshToken: string | null\r\n}\r\n\r\nconst initialState: TUserState = {\r\n\r\n    registerRequest: false,\r\n    registerSuccess: false,\r\n    registerFailed: false,\r\n\r\n    loginRequest: false,\r\n    loginSuccess: false,\r\n    loginFailed: false,\r\n\r\n    logoutRequest: false,\r\n    logoutSuccess: false,\r\n    logoutFailed: false,\r\n\r\n    passwordResetCodeRequest: false,\r\n    passwordResetCodeSuccess: false,\r\n    passwordResetCodeFailed: false,\r\n\r\n    passwordResetRequest: false,\r\n    passwordResetSuccess: false,\r\n    passwordResetFailed: false,\r\n    refreshSuccess: false,\r\n\r\n    accessToken: null,\r\n    accessTokenTimeStamp: null,\r\n    refreshToken: null\r\n}\r\n\r\nexport const user = (state = initialState, action: TUserActions) => {\r\n\r\n    switch (action.type) {\r\n            \r\n        case ActionTypes.REGISTER_REQUEST: \r\n            return {\r\n                ...state, \r\n                registerRequest: true\r\n            };\r\n    \r\n        case ActionTypes.REGISTER_SUCCESS: \r\n            return {\r\n                ...state, \r\n                registerRequest: false,\r\n                registerSuccess: true,\r\n\r\n                accessToken: action.data.accessToken,\r\n                accessTokenTimeStamp: action.data.timeStamp,\r\n                refreshToken: action.data.refreshToken\r\n            };\r\n\r\n        case ActionTypes.REGISTER_FAILED: \r\n            return {\r\n                ...state, \r\n                registerRequest: false,\r\n                registerFailed: true\r\n            };\r\n\r\n            \r\n        case ActionTypes.LOGIN_REQUEST: \r\n            return {\r\n                ...state, \r\n                logoutSuccess: false,\r\n                loginRequest: true,\r\n                refreshSuccess: false\r\n            };\r\n    \r\n        case ActionTypes.LOGIN_SUCCESS: \r\n            return {\r\n                ...state, \r\n                loginRequest: false,\r\n                loginSuccess: true,\r\n\r\n                name: action.user.name,\r\n                email: action.user.email\r\n            };\r\n\r\n        case ActionTypes.LOGIN_FAILED:\r\n            return {\r\n                ...state, \r\n                loginRequest: false,\r\n                loginFailed: true\r\n            }; \r\n\r\n                \r\n        case ActionTypes.LOGOUT_REQUEST: \r\n            return {\r\n                ...state, \r\n                logoutRequest: true\r\n            };\r\n\r\n        case ActionTypes.LOGOUT_SUCCESS: \r\n            return {\r\n                ...state, \r\n                logoutRequest: false,\r\n                logoutSuccess: true,\r\n                loginSuccess: false,\r\n                refreshSuccess: false, \r\n                name: null,\r\n                email: null\r\n            };\r\n\r\n        case ActionTypes.LOGOUT_FAILED:\r\n            return {\r\n                ...state, \r\n                logoutRequest: false,\r\n                logoutFailed: true\r\n            }; \r\n        \r\n        \r\n        case ActionTypes.PASSWORD_RESET_CODE_REQUEST: \r\n            return {\r\n                ...state, \r\n                passwordResetCodeRequest: true\r\n            };\r\n        \r\n        case ActionTypes.PASSWORD_RESET_CODE_SUCCESS: \r\n            return {\r\n                ...state, \r\n                passwordResetCodeRequest: false,\r\n                passwordResetCodeSuccess: true\r\n            };\r\n\r\n        case ActionTypes.PASSWORD_RESET_CODE_FAILED: \r\n            return {\r\n                ...state, \r\n                passwordResetCodeRequest: false,\r\n                passwordResetCodeFailed: true\r\n            }; \r\n            \r\n        \r\n        case ActionTypes.PASSWORD_RESET_REQUEST: \r\n            return {\r\n                ...state, \r\n                passwordResetRequest: true\r\n            };\r\n        \r\n        case ActionTypes.PASSWORD_RESET_SUCCESS: \r\n            return {\r\n                ...state, \r\n                passwordResetRequest: false,\r\n                passwordResetSuccess: true\r\n            };\r\n\r\n        case ActionTypes.PASSWORD_RESET_FAILED: \r\n            return {\r\n                ...state, \r\n                passwordResetRequest: false,\r\n                passwordResetFailed: true,\r\n                passwordResetCodeSuccess: false\r\n            };\r\n        \r\n    \r\n        case ActionTypes.USER_REFRESH_SUCCESS: \r\n        return {\r\n            ...state, \r\n            loginRequest: false,\r\n            loginSuccess: true,\r\n\r\n            name: action.user.name,\r\n            email: action.user.email\r\n        };\r\n\r\n        default: return state;\r\n    }\r\n}","import { socketList } from \"../services/types\";\r\nimport { TIngredientGroup } from \"../services/types\";\r\n\r\nconst ingredientGroups: Array<TIngredientGroup> = [\r\n    { type: 'bun', name: 'Булки' },\r\n    { type: 'sauce', name: 'Соусы' },\r\n    { type: 'main', name: 'Начинки' }\r\n ];\r\n\r\nconst domain = \"https://norma.nomoreparties.space/api\";\r\n\r\nconst dataUrl = domain + \"/ingredients\";\r\nconst orderUrl = domain + \"/orders\";\r\n\r\nconst authEndpoints = {\r\n   registerUrl: domain + \"/auth/register\",\r\n   authUrl: domain + \"/auth/login\", \r\n   logoutUrl: domain + \"/auth/logout\",\r\n   tokenUrl: domain + \"/auth/token\",\r\n   userUrl: domain + \"/auth/user\"\r\n};\r\n\r\nconst ws = \"wss://norma.nomoreparties.space\"\r\nconst allOrdersWS = ws+\"/orders/all\";\r\nconst personalOrdersWS = ws+\"/orders\";\r\n\r\nconst socketType: socketList = {\r\n   allOrders: 'allOrders', \r\n   personalOrders: 'personalOrders'\r\n};\r\n\r\n const passwordResetUrl = domain + \"/password-reset\";\r\n const resetUrl = domain + \"/password-reset/reset\";\r\n\r\nconst accessTokenName = 'rb_accessToken';\r\nconst refreshTokenName = 'rb_refreshToken';\r\n\r\n //TODO: unite urls into objects\r\n export {dataUrl, orderUrl, ingredientGroups, passwordResetUrl, resetUrl, authEndpoints, \r\n         allOrdersWS, personalOrdersWS, socketType,\r\n         accessTokenName, refreshTokenName\r\n};","import { ActionTypes } from \"../actionTypes\";\r\nimport { socketType } from \"../../utils/constants\";\r\nimport { TWSOrderActions, IWSOnError_AllOrders, \r\n         IWSOnError_UserOrders, \r\n         IWSOnGetMessage_AllOrders, IWSOnGetMessage_UserOrders} from \"./actions\";\r\n\r\nexport type TSocketState = {\r\n    wsConnected: boolean;\r\n    error: object | null;\r\n    messages: Array<object>;\r\n    data: object | null;\r\n};\r\n\r\nexport type TAllSocketsState = {\r\n    [name: string]: TSocketState\r\n}\r\n\r\nconst initialState: TAllSocketsState = {};\r\n\r\nfor(let socket in socketType) {\r\n    initialState[socketType[socket]] = {\r\n        wsConnected: false,\r\n        error: null,\r\n        messages: [],\r\n        data: null\r\n    }\r\n};\r\n\r\nconst wsInit = (state: TAllSocketsState, action: TWSOrderActions, socketName: string) => ({\r\n    ...state,\r\n    [socketName]: {\r\n        ...state[socketName],\r\n        error: null,\r\n        wsConnected: true\r\n    }\r\n});\r\n\r\n//это странно, но пришлось явно прописать юнион для экшенов с payload\r\n//компилятор не видит это свойство, я не понимаю в чём проблема, т.к. в другом месте всё то же самое работает :(\r\nconst onError = (state: TAllSocketsState, action: IWSOnError_AllOrders | IWSOnError_UserOrders, socketName: string) => ({\r\n    ...state,\r\n    [socketName]: {\r\n        ...state[socketName],\r\n        error: action.payload,\r\n        wsConnected: false\r\n    }\r\n});\r\n\r\nconst onClose = (state: TAllSocketsState, action: TWSOrderActions, socketName: string) => ({\r\n    ...state,\r\n    [socketName]: {\r\n        ...state[socketName],\r\n        error: null,\r\n        wsConnected: false\r\n    }\r\n});\r\n\r\nconst onGetMessage = (state: TAllSocketsState, action: IWSOnGetMessage_AllOrders | IWSOnGetMessage_UserOrders, socketName: string) => ({\r\n    ...state,\r\n    [socketName]: {\r\n        ...state[socketName],\r\n        error: null,\r\n        data: JSON.parse(action.payload),\r\n        messages: [...state[socketName].messages, JSON.parse(action.payload)]\r\n    } \r\n});\r\n\r\nexport const orders = (state = initialState, action: TWSOrderActions) => {\r\n\r\n    switch (action.type) {\r\n\r\n        case ActionTypes.wsAllOrders.onOpen:\r\n        case ActionTypes.wsUserOrders.onOpen:\r\n            return wsInit(state, action, action.socketName);\r\n\r\n        case ActionTypes.wsAllOrders.onError:\r\n        case ActionTypes.wsUserOrders.onError:\r\n            return onError(state, action, action.socketName);\r\n\r\n        case ActionTypes.wsAllOrders.onClose:\r\n        case ActionTypes.wsUserOrders.onClose:\r\n            return onClose(state, action, action.socketName);\r\n\r\n        case ActionTypes.wsAllOrders.onGetMessage:\r\n        case ActionTypes.wsUserOrders.onGetMessage:\r\n            return onGetMessage(state, action, action.socketName);\r\n\r\n        default:\r\n        return state;\r\n    }\r\n}; \r\n","import { combineReducers } from 'redux';\r\n\r\nimport {ingredients} from './ingredients/reducer';\r\nimport {cart} from './cart/reducer';\r\nimport {user} from './user/reducer';\r\nimport {orders} from './orders/reducer';\r\n\r\n\r\nexport const rootReducer = combineReducers({\r\n    ingredients,\r\n    cart,\r\n    user,\r\n    orders\r\n});","/*\r\nfind cookie by name\r\n*/\r\nexport function getCookie(name: string): string {\r\n    const matches = document.cookie.match(\r\n    new RegExp('(?:^|; )' + name.replace(/([\\.$?*|{}\\(\\)\\[\\]\\\\\\/\\+^])/g, '\\\\$1') + '=([^;]*)')\r\n    );\r\n    return matches ? decodeURIComponent(matches[1]) : '';\r\n}\r\n\r\nexport function getCookieValue(name : string): string | undefined {\r\n    const cookie = getCookie(name);\r\n\r\n    if (cookie && cookie.indexOf('Bearer') === 0) {\r\n        return cookie.split('Bearer ')[1];\r\n    }\r\n\r\n    return cookie;\r\n}\r\n\r\n\r\nexport function setCookie(name:string, value: string, props: {[name:string]: any}) {\r\n    props = props || {};\r\n    let exp = props.expires;\r\n    if (typeof exp == 'number' && exp) {\r\n        const d = new Date();\r\n        d.setTime(d.getTime() + exp * 1000);\r\n        exp = props.expires = d;\r\n    }\r\n    if (exp && exp.toUTCString) {\r\n        props.expires = exp.toUTCString();\r\n    }\r\n    value = encodeURIComponent(value);\r\n    let updatedCookie = name + '=' + value;\r\n    for (const propName in props) {\r\n        updatedCookie += '; ' + propName;\r\n        const propValue = props[propName];\r\n        if (propValue !== true) {\r\n        updatedCookie += '=' + propValue;\r\n        }\r\n    }\r\n    document.cookie = updatedCookie;\r\n}\r\n\r\nexport function deleteCookie(name:string) {\r\n    setCookie(name, '', { expires: -1 });\r\n}\r\n  ","import { accessTokenName, allOrdersWS, personalOrdersWS  } from \"../../utils/constants\";\r\nimport { ActionTypes, TWSUserOrders, TWSAllOrders } from \"../actionTypes\";\r\nimport { getCookieValue } from \"../../utils/cookie\";\r\nimport { RootState } from \"../types\";\r\nimport { Middleware } from 'redux'\r\n\r\nimport { socketType } from \"../../utils/constants\";\r\n\r\n\r\nconst createSocket = (type: string): [socket: WebSocket | null, wsActions: TWSAllOrders|TWSUserOrders | null, socketName: string | null] => {\r\n\r\n\r\n  if (type === ActionTypes.wsAllOrders.wsInit) {\r\n    return [new WebSocket(allOrdersWS), ActionTypes.wsAllOrders, socketType.allOrders];\r\n  }\r\n\r\n  if (type === ActionTypes.wsUserOrders.wsInit && getCookieValue(accessTokenName)) {\r\n    return [new WebSocket(`${personalOrdersWS}?token=${getCookieValue(accessTokenName)}`), ActionTypes.wsUserOrders, socketType.personalOrders];\r\n  }\r\n\r\n  return [null, null, null];\r\n}\r\n\r\nexport const socketMiddleware: Middleware<{}, RootState> = \r\n\r\n  store => next => action => {\r\n  const { dispatch } = store;\r\n  const { type, payload } = action;\r\n  const [socket, wsActions, socketName] = createSocket(type);\r\n  \r\n  if (socket !== null && wsActions !== null) {\r\n\r\n    socket.onopen = event => {\r\n      dispatch({ type: wsActions.onOpen, payload: event, socketName:socketName });\r\n    };\r\n\r\n    socket.onerror = event => {\r\n      dispatch({ type: wsActions.onError, payload: event, socketName:socketName });\r\n    };\r\n\r\n    socket.onmessage = event => {\r\n      const { data } = event;\r\n      dispatch({ type: wsActions.onGetMessage, payload: data, socketName:socketName  });\r\n    };\r\n\r\n    socket.onclose = event => {\r\n      dispatch({ type: wsActions.onClose, payload: event, socketName:socketName });\r\n    };\r\n\r\n    if (type === wsActions.wsSendMessage) {\r\n      const message = payload;\r\n      socket.send(JSON.stringify(message));\r\n    }\r\n  }\r\n  next(action);\r\n\r\n}; ","import thunk from 'redux-thunk';\r\nimport { rootReducer } from './rootReducer';\r\nimport { socketMiddleware } from './middleware/socketMiddleware';\r\n\r\nimport { compose, createStore, applyMiddleware } from 'redux';\r\n\r\ndeclare global {\r\n    interface Window {\r\n      __REDUX_DEVTOOLS_EXTENSION_COMPOSE__?: typeof compose;\r\n    }\r\n  }\r\n\r\nexport const composeEnhancers = window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose;\r\n    \r\nconst enhancer = composeEnhancers(applyMiddleware( thunk, socketMiddleware));\r\nexport const store = createStore(rootReducer, enhancer);","import { ThunkAction } from 'redux-thunk';\r\nimport { ActionCreator } from 'redux';\r\nimport { store } from '../store';\r\nimport { TypedUseSelectorHook, useDispatch, useSelector } from 'react-redux';\r\n\r\nimport { TCartActions } from '../cart/actions';\r\nimport { TIngredientActions } from '../ingredients/actions';\r\nimport { TWSOrderActions } from '../orders/actions';\r\nimport { TUserActions } from '../user/actions';\r\n\r\nimport { rootReducer } from '../rootReducer';\r\n\r\nimport { Location } from \"history\";\r\n\r\nexport interface ILocation extends Location {\r\n    background?: any;\r\n}\r\n\r\nexport type TNavItem = {\r\n    id: string;\r\n    title: string;\r\n    to?: string;\r\n    icon?: any;\r\n    cssClass?: string;\r\n    subitems?: Array<{id: string, title: string}>;\r\n}\r\n\r\nexport type TIngredient = {\r\n    _id: string;\r\n    name: string;\r\n    type: \"bun\" | \"sauce\" |\"main\";\r\n    proteins: number;\r\n    fat: number;\r\n    carbohydrates: number;\r\n    calories: number;\r\n    price: number;\r\n    image: string;\r\n    image_mobile: string;\r\n    image_large: string;\r\n    __v: number;\r\n    key: string;\r\n}\r\n\r\nexport type TOrder = {\r\n    _id: string;\r\n    name: string;\r\n    number: number;\r\n    ingredients: string[];\r\n    updatedAt: string;\r\n    status: string;\r\n}\r\n\r\nexport type TIngredientGroup = {\r\n    type:  'bun' | 'sauce' | 'main';\r\n    name?: string;\r\n}\r\n\r\nexport type TIngredientWithKey = TIngredient & {\r\n    key: string;\r\n}\r\n\r\nexport type TOrderIngredients = {\r\n    bun: TIngredient;\r\n    fillings: Array<TIngredient>;\r\n}\r\n\r\nexport type TOrderDetails = {\r\n    success: boolean;\r\n    order: { number: number};\r\n}\r\n\r\nexport type socketList = {\r\n    [name:string]: string;\r\n}\r\n\r\n//export type RootState = ReturnType<typeof store.getState>;\r\nexport type RootState = ReturnType<typeof rootReducer>;\r\n\r\ntype TApplicationActions = TCartActions & TIngredientActions & TWSOrderActions & TUserActions;\r\n\r\nexport type AppDispatch = typeof store.dispatch; \r\n\r\nexport type AppThunk<TReturn = void> = ActionCreator< ThunkAction<TReturn, RootState, unknown, TApplicationActions> >;\r\n//export type AppThunk<ReturnType = void> = ThunkAction< ReturnType, RootState, unknown, TApplicationActions >\r\n\r\n// Use throughout your app instead of plain `useDispatch` and `useSelector`\r\nexport const useAppDispatch = () => useDispatch<AppDispatch | AppThunk>();\r\nexport const useAppSelector: TypedUseSelectorHook<RootState> = useSelector;\r\n","import React , {FC} from 'react';\r\nimport {NavLink } from 'react-router-dom';\r\n\r\nimport styles from './nav-item.module.css';\r\nimport NavList from '../nav-list/nav-list';\r\nimport {TNavItem} from '../../../services/types/index';\r\n\r\ninterface INavItemProps {\r\n    data: TNavItem;\r\n}\r\n\r\nconst NavItem: FC<INavItemProps> = (props) => {\r\n\r\n    const  {id, title, icon, cssClass, subitems, to} = props.data;\r\n\r\n    const isActive = (match: any) => {\r\n\r\n        if (id === 'logo_desktop' || !match || !match.isExact) {\r\n          return false;\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    return (            \r\n        <li className={ !!cssClass ? styles[cssClass] : styles.nav_item}>  \r\n            <NavLink \r\n            to={to || '/'} \r\n            isActive={isActive}\r\n            className={styles.nav_link} \r\n            activeClassName=\"nav_link-active\" >\r\n                {icon}\r\n                {props.children}\r\n                <span className={styles.link_text}>{title}</span>\r\n            </NavLink>\r\n            { !!subitems && <NavList data = {subitems} type=\"nested\" setDefault={false}/>}\r\n        </li>\r\n    );\r\n     \r\n}\r\n\r\nexport default NavItem;","import React, {FC} from 'react';\r\nimport styles from './nav-list.module.css';\r\nimport NavItem from '../nav-item/nav-item';\r\n\r\nimport {TNavItem} from '../../../services/types/index';\r\n\r\ninterface INavListЗкщзы {\r\n    data: Array<TNavItem>;\r\n    type: \"main\" | \"nested\";\r\n    setDefault: boolean;\r\n}\r\n\r\nconst NavList: FC<INavListЗкщзы> = ({data, type}) => {\r\n\r\n    return (            \r\n        <ul className={ type === 'main' ? styles.main_nav : styles.nested_nav}> \r\n            { data && data.map( item => (\r\n                <NavItem \r\n                key={item.id} \r\n                data={item} />\r\n            ))}\r\n        </ul>\r\n    );\r\n    \r\n}\r\n\r\n\r\nexport default NavList;\r\n\r\n","import React from 'react';\r\nimport styles from './app-header.module.css';\r\nimport {Logo, BurgerIcon, ListIcon, ProfileIcon, CloseIcon}  from '@ya.praktikum/react-developer-burger-ui-components';\r\nimport {MenuIcon} from '@ya.praktikum/react-developer-burger-ui-components/dist/ui/icons/menu-icon';\r\nimport NavList from './nav-list/nav-list';\r\n\r\nconst AppHeader = (): React.ReactElement | null => {\r\n\r\n    const menuItems = [\r\n        {id: \"constructor\", title: \"Конструктор\", to: '/', icon: <BurgerIcon type=\"secondary\"/> }, \r\n        {id: \"feed\", title: \"Лента заказов\", to: '/feed', icon: <ListIcon type=\"secondary\"/> }, \r\n        {id: \"logo_desktop\", title: \"\", to: '/', icon: <Logo/>, cssClass: \"logo_desktop_item\" }, \r\n        {id: \"profile\", title: \"Личный кабинет\", to: '/profile', icon: <ProfileIcon type=\"secondary\"/>, cssClass: \"profile_item\", subitems: [\r\n            {id: \"account\", title: \"Профиль\" }, \r\n            {id: \"history\", title: \"История заказов\" }, \r\n            {id: \"logout\", title: \"Выход\" }\r\n        ] }\r\n    ];\r\n\r\n    return (\r\n        <header  className = {styles.header}>    \r\n\r\n            <h1 className=\"visually-hidden\"><span>Stellar Burger</span></h1>              \r\n\r\n            <nav className = {styles.nav}>\r\n                <div className=\"visibility_mobile\"><Logo/></div>\r\n                <NavList data={menuItems} type=\"main\" setDefault={true}/>                    \r\n                <div className=\"visibility_mobile\"><CloseIcon type=\"primary\"/></div>\r\n                <div className=\"visibility_mobile\"><MenuIcon type=\"primary\"/></div>\r\n            </nav> \r\n\r\n        </header>\r\n    );\r\n}\r\n\r\nexport default AppHeader;","import { FC } from 'react';\r\nimport { Redirect, Route} from 'react-router-dom';\r\n\r\nimport { useAppSelector } from '../../services/types';\r\n\r\n\r\ninterface IRouteForAuthorizedUsersProps {\r\n  [name: string]: any;\r\n}\r\n\r\nconst RouteForAuthorizedUsers: FC<IRouteForAuthorizedUsersProps> = ({ children, ...rest }) => {\r\n\r\n  const { loginSuccess } = useAppSelector(store => store.user);\r\n\r\n  const render = ({location} : {location: any}) => {\r\n\r\n    if(loginSuccess) {\r\n        return children;\r\n    }\r\n    \r\n    return <Redirect to={{ pathname: '/login', state: { target: location } }} />; \r\n  }\r\n\r\n  return <Route {...rest} render={ render } />;\r\n  \r\n}\r\n\r\nexport default RouteForAuthorizedUsers;\r\n","import { FC } from 'react';\r\nimport { useAppSelector } from '../../services/types';\r\nimport { Redirect, Route} from 'react-router-dom';\r\n\r\nconst getNextPage = (location: any) => {\r\n\r\n  let result;\r\n\r\n  if(location && location.state?.target) {\r\n    result = location.state.target;\r\n    delete location.state.target;\r\n  } else {\r\n    result = '/';\r\n  }\r\n\r\n  return result;\r\n}\r\n\r\ninterface IRouteForUnauthorizedUsersProps {\r\n  [name: string]: any;\r\n}\r\n\r\nconst RouteForUnauthorizedUsers: FC<IRouteForUnauthorizedUsersProps> = ({ children, ...rest }) => {\r\n\r\n  const { loginSuccess } = useAppSelector(store => store.user);\r\n\r\n  const render = ({location} : {location: any}) => {\r\n\r\n    if(!loginSuccess) {\r\n        return children;\r\n    }\r\n    \r\n    return <Redirect to={getNextPage(location)}/>; \r\n  }\r\n\r\n  return <Route {...rest} render={ render } />;\r\n  \r\n}\r\n\r\nexport default RouteForUnauthorizedUsers;\r\n","import React, {FC} from 'react';\r\nimport styles from './ingredient-group.module.css';\r\n\r\nimport { TIngredientGroup } from '../../../services/types/index';\r\n\r\ninterface IIngredientGroupProps {\r\n    data: TIngredientGroup\r\n}\r\n\r\nconst IngredientGroup: FC<IIngredientGroupProps> = (props) => {\r\n    \r\n    const {type, name} = props.data;\r\n\r\n    return ( \r\n        <section id={type} key={type} className={styles.group}>\r\n\r\n            <header>\r\n                <h3 className={styles.title}>{name}</h3>\r\n            </header>\r\n\r\n            <ul className={styles.ingredients}>\r\n                {props.children}\r\n            </ul>    \r\n                \r\n        </section>                       \r\n    );\r\n}\r\n\r\nexport default IngredientGroup;","import {orderUrl, accessTokenName} from '../../utils/constants';\r\nimport {ActionTypes} from '../actionTypes';\r\nimport { TOrderDetails, TIngredient, TIngredientWithKey, AppThunk, AppDispatch } from '../types';\r\nimport { getCookie } from '../../utils/cookie';\r\nimport { TCartState } from './reducer';\r\n\r\n//import { rootReducer } from '../rootReducer';\r\n\r\nexport interface IUpdateCart {\r\n    readonly type: typeof ActionTypes.UPDATE_CART;\r\n    readonly updatedCart: TCartState;\r\n}\r\n\r\nexport interface ICreateNewOrderRequest {\r\n    readonly type: typeof ActionTypes.CREATE_NEW_ORDER_REQUEST\r\n}\r\n\r\nexport interface ICreateNewOrderSuccess {\r\n    readonly type: typeof ActionTypes.CREATE_NEW_ORDER_SUCCESS;\r\n    readonly orderDetails: TOrderDetails;\r\n}\r\n\r\nexport interface ICreateNewOrderFailed {\r\n    readonly type: typeof ActionTypes.CREATE_NEW_ORDER_FAILED\r\n}\r\n\r\nexport interface ICloseOrder {\r\n    readonly type: typeof ActionTypes.CLOSE_ORDER\r\n}\r\n\r\nexport type TCartActions = \r\n| IUpdateCart \r\n| ICreateNewOrderFailed\r\n| ICreateNewOrderRequest \r\n| ICreateNewOrderSuccess \r\n| ICloseOrder;\r\n\r\nexport const addIngredientToCart: AppThunk = (ingredientID: string)  => {\r\n\r\n    return (dispatch: AppDispatch, getState)  => {\r\n\r\n        const getIngredientKey = (ingredients: Array<TIngredientWithKey>):number => {\r\n\r\n            const maxAvailableIndex = ingredients.reduce( (res, item) => { \r\n                const currentKey = Number(item.key.split('_')[1]);\r\n                return res < currentKey ? currentKey : res;\r\n            },\r\n            -1);  \r\n            \r\n            return maxAvailableIndex+1;\r\n        }\r\n\r\n        const assignKeyToIngredient = (ingredient: TIngredient):void => {\r\n            if(ingredient.type === \"bun\") {\r\n                ingredient.key = ingredient._id;\r\n                return;\r\n            }\r\n            ingredient.key = [ingredient._id, getIngredientKey(prevCart.fillings)].join('_');\r\n        }\r\n        \r\n        const prevCart = getState().cart;\r\n        const newIngredient = {...getState().ingredients.items.filter( (item: TIngredient) => item._id === ingredientID )[0]};\r\n\r\n        assignKeyToIngredient(newIngredient);\r\n\r\n        const updatedCart = (newIngredient.type === \"bun\") \r\n        ? {...prevCart, bun: newIngredient} \r\n        : {...prevCart, fillings: [...prevCart.fillings, newIngredient] }; \r\n               \r\n        dispatch({type:  ActionTypes.UPDATE_CART, updatedCart: updatedCart});\r\n    }\r\n};\r\n\r\nexport const removeIngredientFromCart: AppThunk = (ingredientKey: string) => {\r\n\r\n    return (dispatch: AppDispatch, getState) => {\r\n\r\n        const prevCart = getState().cart;\r\n        const removedIngredientIndex = prevCart.fillings.findIndex((item: TIngredient) => item.key === ingredientKey);\r\n        const updatedFillings = [...prevCart.fillings];\r\n\r\n        updatedFillings.splice(removedIngredientIndex, 1);\r\n\r\n        dispatch({type:  ActionTypes.UPDATE_CART, updatedCart: {...prevCart, fillings: updatedFillings}});\r\n    }\r\n};\r\n\r\nexport const createOrder: AppThunk = () => {\r\n    \r\n    return (dispatch: AppDispatch, getState) => {\r\n\r\n        dispatch({type:  ActionTypes.CREATE_NEW_ORDER_REQUEST});\r\n\r\n        const prevCart: TCartState = getState().cart;\r\n        const {bun, fillings} = {...prevCart};\r\n\r\n        fetch(orderUrl, {\r\n            method: \"POST\", \r\n            headers: {\r\n                'Content-Type': 'application/json',\r\n                'Authorization': getCookie(accessTokenName)\r\n            },\r\n            body: JSON.stringify({\"ingredients\": [...fillings, bun, bun].map( item => item && item._id)})\r\n        })\r\n        .then(res => res.ok ? res.json() : Promise.reject(res))\r\n        .then(res => {\r\n            dispatch({type: ActionTypes.CREATE_NEW_ORDER_SUCCESS, orderDetails: res}); \r\n        })\r\n        .catch(e => { \r\n            dispatch({type:  ActionTypes.CREATE_NEW_ORDER_FAILED});\r\n        });\r\n    }  \r\n};\r\n\r\nexport const sortFillingsOrder: AppThunk = (oldItemIndex: number, newItemIndex: number) => {\r\n    return (dispatch: AppDispatch, getState) => {\r\n\r\n        const prevCart = getState().cart;\r\n        const newFillings = [...prevCart.fillings];\r\n        \r\n        const itemToMove = newFillings[oldItemIndex];\r\n        newFillings.splice(oldItemIndex,1);\r\n        newFillings.splice(newItemIndex, 0, itemToMove);\r\n\r\n        const updatedCart = {...prevCart, fillings: newFillings }; \r\n               \r\n        dispatch({type:  ActionTypes.UPDATE_CART, updatedCart: updatedCart});\r\n    }\r\n}\r\n","import React, {FC} from 'react';\r\nimport { useDrag } from \"react-dnd\";\r\n\r\nimport styles from './ingredient.module.css';\r\nimport {Counter, CurrencyIcon, Button}  from '@ya.praktikum/react-developer-burger-ui-components';\r\n\r\nimport {addIngredientToCart} from '../../../services/cart/actions';\r\n\r\nimport { useAppSelector, useAppDispatch } from '../../../services/types';\r\nimport { TIngredient } from '../../../services/types/index';\r\n\r\ninterface IIngredient {\r\n    data: TIngredient;\r\n    openModal: (data:TIngredient) => void;\r\n}\r\n\r\nconst Ingredient: FC<IIngredient> = ({ data, openModal}) => {\r\n    \r\n    const dispatch = useAppDispatch();\r\n    const {bun, fillings} = useAppSelector(store => store.cart);\r\n    const [, dragRef] = useDrag({type: 'ingredient', item: {id: data._id}});\r\n\r\n    const ingredientCount = React.useMemo( () => {\r\n            let count = [...fillings, bun].filter( ingredient => ingredient && data._id === ingredient._id).length;\r\n            if(data.type === 'bun' && count>0) {\r\n                count++;\r\n            }\r\n            return count;\r\n    }, [fillings, bun, data._id, data.type]);\r\n\r\n    const addIngredient = (e: React.SyntheticEvent) => {\r\n        e.stopPropagation();\r\n        dispatch(addIngredientToCart(data._id));\r\n    } \r\n\r\n    const openIngredientDetails = (e: React.MouseEvent) => {\r\n        if((e.target as Element).nodeName !== 'BUTTON') {\r\n            openModal(data);\r\n        }\r\n    }\r\n\r\n    const {image, name, price} = data;\r\n\r\n    return (\r\n        <li className={styles.card} onClick={openIngredientDetails} ref={dragRef}> \r\n \r\n            { ingredientCount>0 && <Counter count={ingredientCount}  size=\"default\"/> }\r\n            <img src={image} alt={name} className={styles.image}/>\r\n            <div className={styles.price}> <span className={styles.price_num}>{price}</span> <CurrencyIcon type=\"secondary\" /> </div>\r\n            <div className={styles.name}>{name}</div>\r\n            <div className={styles.add_btn}><Button type=\"secondary\" size=\"medium\" onClick={addIngredient}>Добавить</Button></div>\r\n\r\n        </li>\r\n    );\r\n}\r\n\r\nexport default Ingredient;","import React, {FC} from 'react';\r\nimport {Tab}  from '@ya.praktikum/react-developer-burger-ui-components';\r\nimport {ingredientGroups} from '../../../utils/constants'\r\n\r\ninterface ITabMenu {\r\n    burgerIngredientsEl: {current: HTMLElement | null} ;\r\n    currentTab: 'bun'| 'sauce'| 'main';\r\n    updateCurrentTab: (tabValue:'bun'| 'sauce'| 'main') => any;\r\n}\r\n\r\nconst TabMenu: FC<ITabMenu> = ({burgerIngredientsEl, currentTab, updateCurrentTab}) => {\r\n    \r\n    const scrollIntoSection = (tabValue: string) => {\r\n        const section = burgerIngredientsEl.current && burgerIngredientsEl.current.querySelector(`section[id=${tabValue}]`);\r\n        if(section) {\r\n            section.scrollIntoView({ behavior: \"smooth\" });\r\n            updateCurrentTab(tabValue as 'bun'| 'sauce'| 'main');\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div style={{ display: 'flex' }}>\r\n            { ingredientGroups.map( ingredientGroup => (\r\n                <Tab key={ingredientGroup.type} value={ingredientGroup.type} active={currentTab === ingredientGroup.type} onClick={scrollIntoSection}>\r\n                    {ingredientGroup.name}\r\n                </Tab>\r\n                ))\r\n            }\r\n        </div>\r\n    )\r\n    \r\n}\r\n\r\nexport default TabMenu;","import React, {FC} from 'react';\r\nimport styles from './modal-overlay.module.css';\r\n\r\ninterface IModalOverlayProps {\r\n  onClose: (e: React.MouseEvent | React.KeyboardEvent) => void;\r\n}\r\n\r\nconst ModalOverlay: FC<IModalOverlayProps> = ({onClose}) => {\r\n\r\n    return (\r\n        <div className={styles.backdrop} onClick={onClose}></div>\r\n    );\r\n\r\n} \r\n\r\nexport default ModalOverlay\r\n","import React, { useState, FC } from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport styles from './modal.module.css';\r\nimport {CloseIcon}  from '@ya.praktikum/react-developer-burger-ui-components';\r\nimport ModalOverlay from '../modal-overlay/modal-overlay';\r\n\r\ninterface IModalProps {\r\n    onClose: (e: React.MouseEvent | React.KeyboardEvent) => void;\r\n    type: \"ingredient\" | \"order\" | \"orderInfo\";\r\n}\r\n\r\nconst Modal: FC<IModalProps> = ({ children, onClose, type}) => {\r\n\r\n    //input for tab trap inside modal\r\n    const [activeBeforeModal, setActiveBeforeModal] = useState<HTMLElement | null>(null);\r\n    const [modalControls, setModalControls] = useState<Array<HTMLElement>>([]);\r\n\r\n    const modalComponent = React.useRef<HTMLElement>(null);\r\n\r\n    React.useEffect(() => {\r\n\r\n        setActiveBeforeModal(document.activeElement as HTMLElement);\r\n\r\n        if(modalComponent.current) {\r\n            setModalControls([modalComponent.current, modalComponent.current.querySelector('button') as HTMLElement]);\r\n            modalComponent.current.focus();\r\n        }\r\n\r\n    }, []);\r\n\r\n    const addTabTrap = (e: React.KeyboardEvent) => {\r\n                \r\n        if(e.code === \"Tab\") {            \r\n            const activeElement = document.activeElement;\r\n            \r\n            if(e.shiftKey && activeElement === modalControls[0]) {\r\n                e.preventDefault();\r\n                modalControls[modalControls.length-1].focus();\r\n            }\r\n\r\n            if(activeElement === modalControls[modalControls.length-1]) {\r\n                e.preventDefault();\r\n                modalControls[0].focus();\r\n            } \r\n        }\r\n    }\r\n\r\n    const handleKeyDown = (e: React.KeyboardEvent) => {\r\n\r\n        if(e.code === \"Escape\" && activeBeforeModal) {\r\n            activeBeforeModal.focus();\r\n            onClose(e);            \r\n        }\r\n\r\n        addTabTrap(e);\r\n    }\r\n\r\n    const modalRoot = document.querySelector(\"#modals\") as Element;  \r\n\r\n    return ReactDOM.createPortal(\r\n        (\r\n            <>\r\n                <article className={styles.modal} tabIndex={0} ref={modalComponent} onKeyDown={handleKeyDown}>\r\n                    <button className={styles[\"close_btn_\"+type]} onClick={onClose}><CloseIcon type=\"secondary\"/></button>\r\n                    {children}\r\n                </article>\r\n                <ModalOverlay onClose={onClose}/>\r\n            </>\r\n        ), \r\n        modalRoot\r\n    );\r\n\r\n} \r\n\r\nexport default Modal\r\n","import React from 'react';\r\nimport { useParams } from 'react-router-dom';\r\n\r\nimport { useAppSelector } from '../../services/types';\r\n\r\nimport styles from './ingredient-details.module.css';\r\n\r\nconst IngredientDetails = (): React.ReactElement | null => {\r\n\r\n    const { id } = useParams<{id:string}>();\r\n    const { items } = useAppSelector(store => store.ingredients);\r\n\r\n    const activeIngredientFromStore = useAppSelector(store => store.ingredients.activeIngredient);\r\n    const activeIngredientFromUrl = id ? items.find( item => item._id === id) : null;  \r\n    const activeIngredient = activeIngredientFromUrl || activeIngredientFromStore;\r\n\r\n    if(!activeIngredient) {\r\n        return null;\r\n    }\r\n\r\n    const {name, calories, proteins, fat, carbohydrates, image_large} = activeIngredient;\r\n\r\n    const nutritionItems = [\r\n        {id: \"calories\", title: \"Калории, ккал\", value: calories},\r\n        {id: \"proteins\", title: \"Белки, г\", value: proteins},\r\n        {id: \"fat\", title: \"Жиры, г\", value: fat},\r\n        {id: \"carbohydrates\", title: \"Углеводы, г\", value: carbohydrates}\r\n    ];\r\n\r\n    return (\r\n        <section className={styles.details_section}>\r\n\r\n            <header className={styles.details_header}>Детали ингредиента</header>\r\n            <img src={image_large} alt={name}/>\r\n            <h4 className={styles.details_title}>{name}</h4>\r\n\r\n            <dl className={styles.nutrition_info}>\r\n\r\n                { nutritionItems.map( item => (\r\n                    <div key={item.id} className={styles.nutrition_item}>\r\n                        <dt className={styles.nutrition_title}> {item.title} </dt> \r\n                        <dd className={styles.nutrition_val}> {item.value} </dd>\r\n                    </div>\r\n                    ))\r\n                }                  \r\n            </dl>\r\n        </section>\r\n    );\r\n            \r\n} \r\n\r\nexport default IngredientDetails","import React from 'react';\r\nimport { Link, useLocation, useHistory } from 'react-router-dom';\r\n\r\nimport styles from './burger-ingredients.module.css';\r\n\r\nimport IngredientGroup from './ingredient-group/ingredient-group';\r\nimport Ingredient from './ingredient/ingredient';\r\nimport TabMenu from './tab-menu/tab-menu';\r\nimport Modal from '../modal/modal';\r\nimport IngredientDetails from '../ingredient-details/ingredient-details';\r\n\r\nimport {ingredientGroups} from '../../utils/constants';\r\n\r\nimport {ActionTypes} from '../../services/actionTypes';\r\n\r\nimport { useAppDispatch, useAppSelector, TIngredient, TIngredientGroup } from '../../services/types';\r\n\r\n\r\nconst BurgerIngredients = () => {\r\n\r\n    const location = useLocation();\r\n    const history = useHistory();\r\n\r\n    const [currentTab, setCurrentTab] = React.useState<'bun'| 'sauce'| 'main'>('bun');\r\n    \r\n    const dispatch = useAppDispatch();\r\n    const {items, showIngredientDetails} = useAppSelector(store => store.ingredients);\r\n\r\n    const burgerIngredientsEl = React.useRef<HTMLElement>(null);  \r\n    \r\n    const openModal = (ingredient: TIngredient) => {\r\n        dispatch({type:  ActionTypes.SET_ACTIVE_INGREDIENT, value: ingredient});\r\n        dispatch({type:  ActionTypes.SHOW_INGREDIENT_DETAILS, value: true});\r\n    }\r\n\r\n    const closeModal = (e: React.MouseEvent | React.KeyboardEvent) => {\r\n        e.stopPropagation();\r\n        dispatch({type:  ActionTypes.SHOW_INGREDIENT_DETAILS, value: false});\r\n        dispatch({type:  ActionTypes.SET_ACTIVE_INGREDIENT, value: null});\r\n        history.goBack();\r\n    }\r\n\r\n    const getIngredientsFrom = (group: TIngredientGroup) => (\r\n        items\r\n        .filter(ingredient => ingredient.type === group.type)\r\n        .map((ingredient) => {\r\n            return (\r\n                    <Link key={ingredient._id}  to={{pathname: `/ingredients/${ingredient._id}`, state: { background: location }}}>\r\n                        <Ingredient                             \r\n                            data={ingredient} \r\n                            openModal = {openModal}/>\r\n                    </Link>\r\n                )\r\n            })\r\n    );\r\n\r\n    const updateActiveTabOnScroll = (e: React.UIEvent) => {\r\n        if(!e.target) {\r\n            return;\r\n        }\r\n\r\n        const isClosestHeaderVisible = (section: Element, sectionIndex: number, allSections: Array<object>) => {\r\n\r\n            if(sectionIndex === allSections.length-1) { //last section is active\r\n                return true;\r\n            }\r\n            \r\n            const sectionRect = section.querySelector('ul')!.getBoundingClientRect();\r\n            return sectionRect.y >= scrollableAreaTop;\r\n        }\r\n\r\n        const scrollableArea = e.target as Element;\r\n        const scrollableAreaTop = scrollableArea.getBoundingClientRect().y;\r\n        const ingredientGroups = Array.prototype.slice.call(scrollableArea.querySelectorAll('section'));\r\n\r\n        const visibleGroup = ingredientGroups.find(isClosestHeaderVisible);\r\n\r\n        setCurrentTab(visibleGroup.getAttribute('id'));\r\n    };\r\n    \r\n    return (\r\n        <article className={styles.ingredients}>\r\n            <header>\r\n                <h2 className={styles.title}>Соберите бургер</h2>\r\n            </header> \r\n\r\n            <TabMenu burgerIngredientsEl={burgerIngredientsEl} currentTab={currentTab} updateCurrentTab={setCurrentTab}/>\r\n                \r\n            <section className={styles.ingredient_groups} ref={burgerIngredientsEl} onScroll={updateActiveTabOnScroll}>\r\n                { ingredientGroups.map((group)=>(\r\n                    <IngredientGroup key={group.type} data={group}>   \r\n                        { getIngredientsFrom(group) }                 \r\n                    </IngredientGroup>                                           \r\n                    ))\r\n                } \r\n            </section>    \r\n            \r\n            { showIngredientDetails && \r\n                <Modal type=\"ingredient\" onClose={closeModal}> \r\n                    <IngredientDetails/>\r\n                </Modal> \r\n            }           \r\n        </article>\r\n    );\r\n}\r\n\r\n\r\nexport default BurgerIngredients;","import * as React from \"react\"\r\n\r\nfunction OrderDetailsIcon() {\r\n  return (\r\n    <svg\r\n      width={107}\r\n      height={102}\r\n      viewBox=\"0 0 107 102\"\r\n      fill=\"none\"\r\n      xmlns=\"http://www.w3.org/2000/svg\"\r\n    >\r\n      <path\r\n        fillRule=\"evenodd\"\r\n        clipRule=\"evenodd\"\r\n        d=\"M8.366 37.387c-5.821 8.117-5.821 19.109 0 27.226l19.968 27.839c5.821 8.117 16.14 11.513 25.56 8.413l32.308-10.634C95.622 87.131 102 78.24 102 68.206V33.794c0-10.033-6.378-18.925-15.798-22.025L53.895 1.135c-9.42-3.1-19.74.296-25.561 8.413L8.366 37.388z\"\r\n        fill=\"url(#prefix__paint0_radial)\"\r\n        fillOpacity={0.25}\r\n      />\r\n      <path\r\n        fillRule=\"evenodd\"\r\n        clipRule=\"evenodd\"\r\n        d=\"M103.944 39.453a23.341 23.341 0 010 23.094L88.6 89.453C84.525 96.598 76.994 101 68.844 101H38.156c-8.15 0-15.68-4.402-19.756-11.547L3.056 62.547a23.342 23.342 0 010-23.094L18.4 12.547C22.475 5.402 30.006 1 38.156 1h30.688c8.15 0 15.68 4.402 19.756 11.547l15.344 26.906z\"\r\n        fill=\"url(#prefix__paint1_radial)\"\r\n        fillOpacity={0.25}\r\n      />\r\n      <path\r\n        fillRule=\"evenodd\"\r\n        clipRule=\"evenodd\"\r\n        d=\"M43.925 20.91a15.602 15.602 0 0118.15 0l18.56 13.312c5.41 3.882 7.675 10.761 5.608 17.041l-7.089 21.539c-2.067 6.28-7.995 10.531-14.684 10.531H41.53c-6.69 0-12.617-4.251-14.684-10.531l-7.09-21.539c-2.066-6.28.198-13.16 5.61-17.04L43.925 20.91z\"\r\n        fill=\"url(#prefix__paint2_radial)\"\r\n        fillOpacity={0.25}\r\n      />\r\n      <path\r\n        fillRule=\"evenodd\"\r\n        clipRule=\"evenodd\"\r\n        d=\"M73.312 37.596c.888.821.92 2.185.073 3.045L50.052 64.333a2.257 2.257 0 01-1.63.667 2.255 2.255 0 01-1.616-.698L34.584 51.378a2.108 2.108 0 01.137-3.043 2.272 2.272 0 013.14.133l10.616 11.225L70.17 37.667a2.272 2.272 0 013.142-.071z\"\r\n        fill=\"#F2F2F3\"\r\n      />\r\n      <defs>\r\n        <radialGradient\r\n          id=\"prefix__paint0_radial\"\r\n          cx={0}\r\n          cy={0}\r\n          r={1}\r\n          gradientUnits=\"userSpaceOnUse\"\r\n          gradientTransform=\"matrix(48.99995 -51.00002 38.36416 36.85964 53 51)\"\r\n        >\r\n          <stop stopColor=\"#801AB3\" stopOpacity={0} />\r\n          <stop offset={1} stopColor=\"#4C4CFF\" />\r\n        </radialGradient>\r\n        <radialGradient\r\n          id=\"prefix__paint1_radial\"\r\n          cx={0}\r\n          cy={0}\r\n          r={1}\r\n          gradientUnits=\"userSpaceOnUse\"\r\n          gradientTransform=\"matrix(53.50001 -50.00001 37.55596 40.18488 53.5 51)\"\r\n        >\r\n          <stop stopColor=\"#801AB3\" stopOpacity={0} />\r\n          <stop offset={1} stopColor=\"#4C4CFF\" />\r\n        </radialGradient>\r\n        <radialGradient\r\n          id=\"prefix__paint2_radial\"\r\n          cx={0}\r\n          cy={0}\r\n          r={1}\r\n          gradientUnits=\"userSpaceOnUse\"\r\n          gradientTransform=\"rotate(136.146 16.302 36) scale(47.1499 35.4679)\"\r\n        >\r\n          <stop stopColor=\"#801AB3\" stopOpacity={0} />\r\n          <stop offset={1} stopColor=\"#4C4CFF\" stopOpacity={0.5} />\r\n        </radialGradient>\r\n      </defs>\r\n    </svg>\r\n  )\r\n}\r\n\r\nexport default OrderDetailsIcon\r\n","import React from 'react';\r\nimport { useAppSelector } from '../../services/types';\r\n\r\nimport styles from './order-details.module.css';\r\nimport OrderDetailsIcon from './order-details-icon'\r\n\r\nconst OrderDetails = () => {\r\n\r\n    const {orderDetails} = useAppSelector(store => store.cart);\r\n    const notes_main = orderDetails?.success ? \"Ваш заказ начали готовить\": \"Заказ не может быть выполнен\";\r\n    const notes_sec = orderDetails?.success ? \"Дождитесь готовности на орбитальной станции\": \"Обратитесь в поддержку\";\r\n\r\n    return (      \r\n        <section className={styles.info_section}>\r\n            <header className={styles.orderId}>{orderDetails?.order.number}</header>\r\n            <p className={styles.orderId_note}>идентификатор заказа</p>\r\n\r\n            <OrderDetailsIcon />\r\n\r\n            <p className={styles.common_notes_main}>{notes_main}</p>\r\n            <p className={styles.common_notes_sec}>{notes_sec}</p>\r\n        </section>\r\n    );\r\n} \r\n\r\nexport default OrderDetails\r\n\r\n","import React from 'react';\r\nimport { useHistory, useLocation } from 'react-router-dom';\r\n\r\nimport styles from './burger-constructor-total.module.css';\r\nimport Modal from '../../modal/modal';\r\nimport OrderDetails from '../../order-details/order-details';\r\nimport {CurrencyIcon, Button}  from '@ya.praktikum/react-developer-burger-ui-components';\r\n\r\nimport {ActionTypes} from '../../../services/actionTypes';\r\nimport {createOrder} from '../../../services/cart/actions';\r\n\r\nimport { useAppSelector, useAppDispatch } from '../../../services/types';\r\n\r\n\r\nconst BurgerConstructorTotal = () => {\r\n\r\n    const dispatch = useAppDispatch();\r\n    const {bun, fillings, showOrderDetails} = useAppSelector(store => store.cart);\r\n    const {loginSuccess} = useAppSelector(store => store.user);\r\n    const {createOrderInProgress} = useAppSelector(store => store.cart);\r\n\r\n    const history = useHistory();\r\n    const location = useLocation();\r\n\r\n    const handleCreateNewOrder = () => {\r\n\r\n        if(!loginSuccess) {\r\n            history.replace({ pathname: '/login', state: { target: location } });\r\n            return;\r\n        }\r\n\r\n        dispatch(createOrder());\r\n    }\r\n    \r\n    const closeModal = (e: React.MouseEvent | React.KeyboardEvent) => {\r\n        e.stopPropagation();\r\n        dispatch({type:  ActionTypes.CLOSE_ORDER});\r\n    };\r\n\r\n    const calcTotal = React.useMemo(\r\n        () => { \r\n            let result  = 0;\r\n\r\n            if(!!bun) {\r\n                result += 2*bun.price;\r\n            }\r\n\r\n            if(fillings.length > 0) {\r\n                result += fillings.reduce((acc, filling) => acc + filling.price, 0);\r\n            }\r\n\r\n            return result;\r\n        },\r\n        [bun, fillings]\r\n    );\r\n\r\n    return (\r\n        <section className={styles.constructor_total}>\r\n            <span> {calcTotal} </span> \r\n            <CurrencyIcon type=\"secondary\"/>\r\n            <div className={styles.button_wrapper}>\r\n                { (bun && !createOrderInProgress) && <Button onClick={handleCreateNewOrder}>Оформить заказ</Button > }\r\n                { createOrderInProgress && <span className={styles.info_important}> Ожидайте подтверждения заказа </span> }\r\n                { showOrderDetails &&\r\n                    <Modal type=\"order\" onClose={closeModal}> \r\n                        <OrderDetails />\r\n                    </Modal>\r\n                }\r\n            </div>                 \r\n        </section>\r\n    );\r\n}\r\n\r\nexport default BurgerConstructorTotal;","import React, {FC} from 'react';\r\nimport styles from './burger-constructor-item.module.css';\r\nimport { useDrag, useDrop } from \"react-dnd\";\r\n\r\nimport {ConstructorElement, DragIcon}  from '@ya.praktikum/react-developer-burger-ui-components';\r\n\r\nimport {removeIngredientFromCart, sortFillingsOrder} from '../../../services/cart/actions'\r\nimport { useAppDispatch  } from '../../../services/types';\r\n\r\n\r\ninterface IBurgerConstructorItem {\r\n    index: number;\r\n    id: string;\r\n    text: string;\r\n    price: number;\r\n    thumbnail: string;\r\n    isLocked: boolean;\r\n}\r\n\r\nconst BurgerConstructorItem: FC<IBurgerConstructorItem> = ({index, id, text, price, thumbnail, isLocked}) => {\r\n    \r\n    const dispatch = useAppDispatch();\r\n    const ref = React.useRef<HTMLDivElement>(null);\r\n    \r\n    const [{isDragging}, drag] = useDrag({\r\n\r\n        type: \"fillings\", \r\n        item: {id, index},\r\n        collect: monitor => ({\r\n            isDragging: monitor.isDragging()\r\n        })\r\n    });\r\n\r\n    const [, drop] = useDrop({\r\n        accept:'fillings',\r\n        hover(item: any, monitor: any) {\r\n\r\n            const dragIndex = item.index;\r\n            const hoverIndex = index;\r\n\r\n            if(dragIndex === hoverIndex ) {\r\n                return;\r\n            }\r\n\r\n            const node = ref.current!.querySelector('div');\r\n            const hoverBoundingRect = node!.getBoundingClientRect();            \r\n            const hoverMiddleY = (hoverBoundingRect.bottom - hoverBoundingRect.top) / 2;\r\n\r\n            const clientOffset = monitor.getClientOffset(); //cursor position when it intersects drop target\r\n            const hoverClientY = clientOffset.y - hoverBoundingRect.top;\r\n\r\n            if (dragIndex < hoverIndex && hoverClientY < hoverMiddleY) { //downwards\r\n                return;\r\n            }\r\n\r\n            if (dragIndex > hoverIndex && hoverClientY > hoverMiddleY) { //upwards\r\n                return;\r\n            }\r\n\r\n            dispatch(sortFillingsOrder(dragIndex, hoverIndex));\r\n            monitor.getItem().index = hoverIndex;\r\n        }\r\n    });\r\n\r\n    const removeIngredient = (ingredientKey: string) => {\r\n        dispatch(removeIngredientFromCart(ingredientKey));\r\n    }\r\n\r\n    const style = { cursor: \"grabbing\"};\r\n    const opacity = isDragging ? 0 : 1;\r\n    drag(drop(ref));\r\n\r\n    return (\r\n            <div id={id} className={styles.burgerIngredient} ref={ref}  style={{ ...style, opacity}}>\r\n                <div className={styles.dragIcon}><DragIcon type=\"primary\" /></div>\r\n                <ConstructorElement\r\n                isLocked={isLocked}\r\n                text={text}\r\n                price={price}\r\n                thumbnail={thumbnail}\r\n                handleClose={() => removeIngredient(id)}/>\r\n            </div>\r\n    )\r\n\r\n}\r\n\r\nexport default BurgerConstructorItem","import React from 'react';\r\nimport { useDrop } from \"react-dnd\";\r\n\r\nimport styles from './burger-constructor.module.css';\r\nimport {ConstructorElement}  from '@ya.praktikum/react-developer-burger-ui-components';\r\nimport BurgerConstructorTotal  from './burger-constructor-total/burger-constructor-total';\r\nimport BurgerConstructorItem from './burger-constructor-item/burger-constructor-item';\r\n\r\nimport {addIngredientToCart} from '../../services/cart/actions';\r\n\r\nimport { useAppSelector, useAppDispatch } from '../../services/types';\r\n\r\ninterface IDropItem {\r\n    key: string; \r\n    index: string;\r\n    id: string;\r\n    isLocked: boolean;\r\n    text: string;\r\n    price: string;\r\n    thumbnail: string;\r\n}\r\n\r\nconst BurgerConstructor = () => {\r\n\r\n    const dispatch = useAppDispatch();\r\n    const {bun, fillings} = useAppSelector(store => store.cart);\r\n\r\n    const [, dropTarget] = useDrop({\r\n        accept:'ingredient',\r\n        drop(item: IDropItem) {\r\n            dispatch(addIngredientToCart(item.id));\r\n        } \r\n    });\r\n\r\n    const fillingsItems = fillings.map( (filling, index) => (\r\n        <BurgerConstructorItem\r\n        key = {filling.key} \r\n        index = {index}\r\n        id = {filling.key}\r\n        isLocked={false} \r\n        text={filling.name} \r\n        price={filling.price} \r\n        thumbnail={filling.image} />                                \r\n    ));\r\n\r\n    const cartHasItems = bun || fillings.length > 0;    \r\n\r\n    return (\r\n        <article className={styles.constructor_area} ref={dropTarget} >\r\n            { cartHasItems \r\n                ? (<>\r\n                        <div className = {styles.main_area}>\r\n\r\n                            { bun != null && \r\n                            <ConstructorElement type=\"top\" isLocked={true} text={bun.name+\" (верх)\"} price={bun.price} thumbnail={bun.image} /> \r\n                            }\r\n\r\n                            <div className={styles.scrollable_area}> \r\n                                {fillingsItems}  \r\n                            </div>\r\n\r\n                            { bun != null &&\r\n                            <ConstructorElement type=\"bottom\" isLocked={true} text={bun.name+\" (низ)\"} price={bun.price} thumbnail={bun.image} />\r\n                            }\r\n\r\n                        </div>\r\n                        <BurgerConstructorTotal/>\r\n                    </>)\r\n                : <p className={styles.emptyConstructor}>Добавьте сюда ингредиенты</p>\r\n            }                            \r\n        </article>\r\n    ); \r\n}\r\n\r\nexport default BurgerConstructor;","import { DndProvider } from \"react-dnd\";\r\nimport { HTML5Backend } from \"react-dnd-html5-backend\";\r\n\r\nimport BurgerIngredients from '../components/burger-ingredients/burger-ingredients';\r\nimport BurgerConstructor from '../components/burger-constructor/burger-constructor';\r\n\r\nimport { useAppSelector } from '../services/types';\r\n \r\nfunction MainPage() {\r\n\r\n  const { ingredientsLoad, ingredientsLoadSuccess, ingredientsLoadFailed } = useAppSelector(store => store.ingredients);\r\n \r\n  return (\r\n    <>\r\n    { ingredientsLoad && <p>Данные загружаются</p> }\r\n    { ingredientsLoadFailed && <p>Ошибка загрузки данных</p>}\r\n    { ingredientsLoadSuccess && \r\n        <DndProvider backend={HTML5Backend}>\r\n            <BurgerIngredients/>\r\n            <BurgerConstructor/>\r\n        </DndProvider>\r\n    }\r\n    </>\r\n  );\r\n}\r\n\r\nexport default MainPage;\r\n","import React, { FC, useMemo } from 'react';\r\nimport styles from './app-form.module.css';\r\n\r\ninterface IAppForm {\r\n    title?: string,\r\n    onSubmit?: (e: React.FormEvent) => void,\r\n    additionalStyles?: string[]\r\n}\r\n\r\nconst AppForm:FC<IAppForm> = ({children, title, onSubmit, additionalStyles}) => {\r\n\r\n    const getFormStyles = useMemo( () => {\r\n\r\n        const defaultStyles = [styles['centeredForm']];\r\n        return additionalStyles ? defaultStyles.concat( additionalStyles.map( style => styles[style]) ) : defaultStyles;\r\n    },\r\n    [additionalStyles]);\r\n\r\n\r\n    return (\r\n        <form className={getFormStyles.join(' ')} onSubmit={onSubmit}>\r\n\r\n            { title && <header>  <h2 className={styles.title}>{title}</h2> </header> }\r\n\r\n            {children}\r\n\r\n        </form>\r\n    );\r\n\r\n}\r\n\r\nexport default AppForm;","import { refreshTokenName, accessTokenName } from \"./constants\";\r\nimport { authEndpoints } from \"./constants\";\r\nimport { getCookie, setCookie } from \"./cookie\";\r\n\r\nconst serverRequest = (url: string, options: {[name: string]: any}) => {\r\n\r\n    return fetch(url, options)\r\n            .then(res => res.ok ? res.json() : Promise.reject(res))\r\n            .then(res => res.success ? res : Promise.reject(res))\r\n            .catch( res => {\r\n                console.log('please authorize');\r\n            });\r\n};\r\n\r\nexport const refreshToken = () => {\r\n\r\n    return serverRequest(authEndpoints.tokenUrl, {\r\n      method: 'POST',\r\n      headers: {\r\n          'Content-Type': 'application/json'\r\n      },\r\n      body: JSON.stringify({\"token\": window.localStorage.getItem(refreshTokenName)})\r\n    }).catch( res => {console.log('refresh token')});\r\n}\r\n\r\nexport const getProfileSettings = () => {\r\n\r\n    return serverRequest(authEndpoints.userUrl, {\r\n        method: 'GET',\r\n        headers: {\r\n            'Content-Type': 'application/json',\r\n            'Authorization': getCookie(accessTokenName)\r\n        }\r\n    }).catch( res => {console.log('profile setting')});\r\n}\r\n\r\nexport const updateProfileSettings = (updatedUserSettings: object) => {\r\n\r\n    return serverRequest(authEndpoints.userUrl, {\r\n        method: 'PATCH',\r\n        headers: {\r\n            'Content-Type': 'application/json',\r\n            authorization: getCookie(accessTokenName)\r\n        },\r\n        body: JSON.stringify(updatedUserSettings)\r\n    }).catch( res => {console.log('updateProfileSettings')});\r\n}\r\n\r\nexport const setToken = (data : {accessToken: string, refreshToken: string}) : void => {\r\n    setCookie(accessTokenName, data.accessToken, {expires: 20*60});\r\n    window.localStorage.setItem(refreshTokenName, data.refreshToken); \r\n}","import {authEndpoints, passwordResetUrl, resetUrl} from '../../utils/constants';\r\nimport {setCookie, deleteCookie} from '../../utils/cookie';\r\n\r\nimport {ActionTypes} from '../actionTypes';\r\n\r\nimport { accessTokenName,  refreshTokenName} from '../../utils/constants';\r\nimport { getProfileSettings, updateProfileSettings, refreshToken, setToken } from '../../utils/token';\r\nimport { AppThunk, AppDispatch } from '../types';\r\n\r\n\r\nexport interface IRegisterRequest {\r\n    readonly type: typeof ActionTypes.REGISTER_REQUEST;\r\n}\r\nexport interface IRegisterSuccess {\r\n    readonly type: typeof ActionTypes.REGISTER_SUCCESS;\r\n    readonly data: {[name : string]: string };\r\n}\r\nexport interface IRegisterFailed {\r\n    readonly type: typeof ActionTypes.REGISTER_FAILED;\r\n}\r\n\r\nexport interface ILoginRequest {\r\n    readonly type: typeof ActionTypes.LOGIN_REQUEST;\r\n}\r\nexport interface ILoginSuccess {\r\n    readonly type: typeof ActionTypes.LOGIN_SUCCESS;\r\n    readonly user: {[name: string]: string};\r\n}\r\nexport interface ILoginFailed {\r\n    readonly type: typeof ActionTypes.LOGIN_FAILED;\r\n}\r\n\r\nexport interface ILogoutRequest {\r\n    readonly type: typeof ActionTypes.LOGOUT_REQUEST;\r\n}\r\nexport interface ILogoutSuccess {\r\n    readonly type: typeof ActionTypes.LOGOUT_SUCCESS;\r\n}\r\nexport interface ILogoutFailed {\r\n    readonly type: typeof ActionTypes.LOGOUT_FAILED;\r\n}\r\n\r\nexport interface IPasswordResetCodeRequest {\r\n    readonly type: typeof ActionTypes.PASSWORD_RESET_CODE_REQUEST;\r\n}\r\nexport interface IPasswordResetCodeSuccess {\r\n    readonly type: typeof ActionTypes.PASSWORD_RESET_CODE_SUCCESS;\r\n}\r\nexport interface IPasswordResetCodeFailed {\r\n    readonly type: typeof ActionTypes.PASSWORD_RESET_CODE_FAILED;\r\n}\r\n\r\nexport interface IPasswordResetRequest {\r\n    readonly type: typeof ActionTypes.PASSWORD_RESET_REQUEST;\r\n}\r\nexport interface IPasswordResetSuccess {\r\n    readonly type: typeof ActionTypes.PASSWORD_RESET_SUCCESS;\r\n}\r\nexport interface IPasswordResetFailed {\r\n    readonly type: typeof ActionTypes.PASSWORD_RESET_FAILED;\r\n}\r\n\r\nexport interface IUserRefreshSuccess {\r\n    readonly type: typeof ActionTypes.USER_REFRESH_SUCCESS;\r\n    readonly user: {[name: string]: string};\r\n}\r\n\r\nexport type TUserActions = | IRegisterRequest\r\n| IRegisterSuccess\r\n| IRegisterFailed\r\n| ILoginRequest\r\n| ILoginSuccess\r\n| ILoginFailed\r\n| ILogoutRequest\r\n| ILogoutSuccess\r\n| ILogoutFailed\r\n| IPasswordResetCodeRequest\r\n| IPasswordResetCodeSuccess\r\n| IPasswordResetCodeFailed\r\n| IPasswordResetRequest\r\n| IPasswordResetSuccess\r\n| IPasswordResetFailed\r\n| IUserRefreshSuccess;\r\n\r\nexport const register = (email: string, password: string, name: string) => {\r\n\r\n    return (dispatch: AppDispatch) => {\r\n\r\n        dispatch({type: ActionTypes.REGISTER_REQUEST});\r\n\r\n        fetch(authEndpoints.registerUrl, {\r\n            method: \"POST\",\r\n            headers: {\r\n                'Content-Type': 'application/json'\r\n            },\r\n            body: JSON.stringify({\r\n                \"email\": email, \r\n                \"password\": password, \r\n                \"name\": name \r\n            } )\r\n        })\r\n        .then(res => res.ok ? res.json() : Promise.reject(res))\r\n        .then(res => {\r\n            /*\r\n                {\r\n                    \"success\": true,\r\n                    \"user\": {\r\n                        \"email\": \"\",\r\n                        \"name\": \"\"\r\n                    },\r\n                    \"accessToken\": \"Bearer ...\",\r\n                    \"refreshToken\": \"\"\r\n                } \r\n            */\r\n           if(res.success) {\r\n               setCookie(accessTokenName, res.accessToken, {expires: 20*60});\r\n               window.localStorage.setItem(refreshTokenName, res.refreshToken);\r\n               dispatch({type:  ActionTypes.REGISTER_SUCCESS, \r\n                         data: {...res, timeStamp: new Date()}\r\n                        });\r\n           } else {\r\n               throw new Error('Registration failed');\r\n           }\r\n            \r\n        })\r\n        .catch( res => {\r\n            //TODO: error handling\r\n            console.log('Registration failed'+res);            \r\n            dispatch({type:  ActionTypes.REGISTER_FAILED});\r\n        });\r\n\r\n    }\r\n};\r\n\r\nexport const login: AppThunk = (email: string, password: string) => {\r\n\r\n    return (dispatch: AppDispatch) => {\r\n\r\n        dispatch({type: ActionTypes.LOGIN_REQUEST});\r\n\r\n        fetch(authEndpoints.authUrl, {\r\n            method: \"POST\",\r\n            headers: {\r\n                'Content-Type': 'application/json'\r\n            },\r\n            body: JSON.stringify({\r\n                \"email\": email, \r\n                \"password\": password\r\n            } )\r\n        })\r\n        .then(res => res.ok ? res.json() : Promise.reject(res))\r\n        .then(res => {\r\n            /*\r\n                {\r\n                    \"success\": true,\r\n                    \"accessToken\": \"Bearer ...\",\r\n                    \"refreshToken\": \"\",\r\n                    \"user\": {\r\n                        \"email\": \"\",\r\n                        \"name\": \"\"\r\n                    }\r\n                } \r\n            */\r\n           if(res.success) {\r\n               setToken(res);\r\n               dispatch({type:  ActionTypes.LOGIN_SUCCESS, user: res.user});\r\n            } else {\r\n               throw new Error('Login failed');\r\n            }\r\n        })\r\n        .catch( res => {\r\n            //TODO: error handling\r\n            console.log('Login failed'+res);            \r\n            dispatch({type:  ActionTypes.LOGIN_FAILED});\r\n        })\r\n\r\n    }\r\n};\r\n\r\nexport const logout: AppThunk = () => {\r\n\r\n    return (dispatch: AppDispatch) => {\r\n\r\n        dispatch({type: ActionTypes.LOGOUT_REQUEST});\r\n\r\n        fetch(authEndpoints.logoutUrl, {\r\n            method: \"POST\",\r\n            headers: {\r\n                'Content-Type': 'application/json'\r\n            },\r\n            body: JSON.stringify({\r\n                \"token\": window.localStorage.getItem(refreshTokenName)\r\n            } )\r\n        })\r\n        .then(res => res.ok ? res.json() : Promise.reject(res))\r\n        .then((res) => {\r\n            /*\r\n                {\r\n                    \"success\": true,\r\n                    \"message\": \"Successful logout\"\r\n                } \r\n            */\r\n            if(res.success) { \r\n                deleteCookie(accessTokenName);\r\n                window.localStorage.removeItem(refreshTokenName);\r\n                dispatch({type:  ActionTypes.LOGOUT_SUCCESS});            \r\n            } else {\r\n                throw new Error('Logout failed');\r\n            }      \r\n        })\r\n        .catch( res => {\r\n            //TODO: error handling\r\n            console.log('Logout failed'+res);     \r\n            dispatch({type:  ActionTypes.LOGOUT_FAILED});\r\n        });\r\n\r\n    }\r\n};\r\n\r\nexport const requestPasswordResetCode: AppThunk = (email: string) => {\r\n\r\n    return (dispatch: AppDispatch) => {\r\n\r\n        dispatch({type: ActionTypes.PASSWORD_RESET_CODE_REQUEST});\r\n\r\n        fetch(passwordResetUrl, {\r\n            method: \"POST\",\r\n            headers: {\r\n                'Content-Type': 'application/json'\r\n            },\r\n            body: JSON.stringify({\"email\": email})\r\n        })\r\n        .then(res => res.ok ? res.json() : Promise.reject(res))\r\n        .then(res => {\r\n            if(res.success) {\r\n                dispatch({type:  ActionTypes.PASSWORD_RESET_CODE_SUCCESS});\r\n            } else {\r\n                throw new Error('requestPasswordResetCode failed');\r\n            }            \r\n        })\r\n        .catch( res => {\r\n            console.log('requestPasswordResetCode failed '+res);\r\n            dispatch({type:  ActionTypes.PASSWORD_RESET_CODE_FAILED});\r\n        });\r\n\r\n    }\r\n\r\n\r\n};\r\n\r\nexport const resetPassword: AppThunk = (password: string, verificationToken: string) => {\r\n\r\n    return (dispatch: AppDispatch) => {\r\n\r\n        dispatch({type: ActionTypes.PASSWORD_RESET_REQUEST});\r\n\r\n        fetch(resetUrl, {\r\n            method: \"POST\",\r\n            headers: {\r\n                'Content-Type': 'application/json'\r\n            },\r\n            body: JSON.stringify({\r\n                \"password\": password,\r\n                \"token\": verificationToken\r\n            })\r\n        })\r\n        .then(res => res.ok ? res.json() : Promise.reject(res))\r\n        .then(res => {\r\n            if(res.success) {\r\n                dispatch({type: ActionTypes.PASSWORD_RESET_SUCCESS});\r\n            } else {\r\n                console.log('resetPassword failed');\r\n            }\r\n        })\r\n        .catch( res => {\r\n            console.log('resetPassword failed '+res);\r\n            dispatch({type: ActionTypes.PASSWORD_RESET_FAILED});\r\n        });\r\n    }\r\n    \r\n}\r\n\r\nexport const runServerRequest = (dispatch: AppDispatch, requestFunction:(f:any) => Promise<any>, requestFunctionParams: object | undefined) => {\r\n\r\n    requestFunction(requestFunctionParams).then( res => {\r\n        dispatch({type: ActionTypes.USER_REFRESH_SUCCESS, user: res.user});\r\n      })\r\n      .catch( res => {\r\n\r\n\r\n        if(res.status === 401 || res.message === 'jwt expired') {\r\n\r\n          refreshToken().then( res => {\r\n              setToken(res);\r\n              requestFunction(requestFunctionParams)\r\n              .then(res => {\r\n                dispatch({type: ActionTypes.USER_REFRESH_SUCCESS, user: res.user});\r\n              })\r\n          })\r\n          .catch( () => {\r\n              console.log('token didn\\'t refresh');\r\n          });\r\n\r\n        } else {\r\n          console.log('something went wrong with authorization: try re-login')\r\n        }\r\n\r\n      })\r\n}\r\n\r\nexport const refreshUser: AppThunk = () => {\r\n\r\n    return (dispatch: AppDispatch) => {\r\n        runServerRequest(dispatch, getProfileSettings, undefined);\r\n    }\r\n}\r\n\r\nexport const updateUser: AppThunk = (updatedUserSettings: object) => {\r\n\r\n    return (dispatch: AppDispatch) => {\r\n        runServerRequest(dispatch, updateProfileSettings, updatedUserSettings);\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\n\r\n","import React from 'react';\r\nimport { Link } from 'react-router-dom';\r\nimport {EmailInput, PasswordInput, Button} from '@ya.praktikum/react-developer-burger-ui-components';\r\n\r\nimport AppForm from '../components/app-form/app-form';\r\nimport {login} from '../services/user/actions';\r\nimport styles from './index.module.css';\r\n\r\nimport { useAppDispatch } from '../services/types';\r\n\r\nfunction LoginPage() {\r\n\r\n    const dispatch = useAppDispatch();\r\n    const [credentials, setCredentials] = React.useState({email: '', password: ''}); \r\n\r\n    const onInputChange = (e: React.ChangeEvent) => {\r\n        const name = (e.target as HTMLInputElement).name;\r\n        const value = (e.target as HTMLInputElement).value;\r\n        setCredentials((prevVal) => ({...prevVal, [name]: value}));\r\n    }\r\n\r\n    const handleLogin = (e: React.FormEvent) => {  \r\n        e.preventDefault();  \r\n        dispatch(login(credentials.email, credentials.password));         \r\n    }\r\n\r\n    return (\r\n        <AppForm title='Вход' onSubmit={handleLogin}>\r\n            <div className={styles.input}>\r\n                <EmailInput name={'email'} value={credentials.email} onChange={onInputChange}/>\r\n            </div>\r\n            <div className={styles.input}>\r\n                <PasswordInput name={'password'} value={credentials.password} onChange={onInputChange}/>\r\n            </div>\r\n            <div className={styles.button}><Button >Войти</Button ></div>\r\n\r\n            <p className={styles.helpRedirect}>\r\n                Вы новый пользователь? \r\n                <Link to='/register' className={styles.link}>Зарегистрироваться</Link> \r\n            </p>\r\n\r\n            <p className={styles.helpRedirect}>\r\n                Забыли пароль? \r\n                <Link to='/forgot-password' className={styles.link}>Восстановить пароль</Link>\r\n            </p>\r\n\r\n        </AppForm>\r\n    );\r\n}\r\n\r\nexport default LoginPage;\r\n","import React, { useState } from 'react';\r\nimport { useHistory, Link } from 'react-router-dom';\r\nimport {Input, EmailInput, PasswordInput, Button} from '@ya.praktikum/react-developer-burger-ui-components';\r\n\r\nimport AppForm from '../components/app-form/app-form';\r\nimport {register} from '../services/user/actions';\r\n\r\nimport styles from './index.module.css';\r\n\r\nimport { useAppSelector, useAppDispatch } from '../services/types';\r\n\r\nfunction RegisterPage() {\r\n\r\n    const dispatch = useAppDispatch();\r\n    const [registerInfo, setRegisterInfo] = useState({name: '', email: '', password: ''});\r\n    const {registerSuccess} = useAppSelector(store => store.user); \r\n    let history = useHistory();   \r\n\r\n    React.useEffect( () => {\r\n\r\n        if(registerSuccess) {\r\n            history.push('/login');\r\n        }\r\n        \r\n    }, [history, registerSuccess]);\r\n\r\n    const onChange = (e: React.ChangeEvent) => {\r\n        const elem = e.target as HTMLInputElement;\r\n        setRegisterInfo({...registerInfo, [elem.name]: elem.value});\r\n    }\r\n    \r\n    const handleRegistration = (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n        dispatch(register(registerInfo.email, registerInfo.password, registerInfo.name));\r\n    }\r\n\r\n    return (\r\n        <AppForm title='Регистрация' onSubmit={handleRegistration}>\r\n            <div className={styles.input}><Input type=\"text\" name={'name'} placeholder={'Имя'} value={registerInfo.name} onChange={onChange}/></div>\r\n            <div className={styles.input}><EmailInput name={'email'} value={registerInfo.email} onChange={onChange}/></div>\r\n            <div className={styles.input}><PasswordInput name={'password'} value={registerInfo.password} onChange={onChange}/></div>\r\n            <div className={styles.button}><Button>Зарегистрироваться</Button ></div>\r\n\r\n            <p className={styles.helpRedirect}>\r\n                Уже зарегистрированы?\r\n                <Link to='/login' className={styles.link}>Войти</Link> \r\n            </p>\r\n\r\n        </AppForm>\r\n    );\r\n}\r\n\r\nexport default RegisterPage;\r\n","import React from 'react';\r\nimport { Link , useHistory} from 'react-router-dom';\r\nimport {Input, Button} from '@ya.praktikum/react-developer-burger-ui-components';\r\n\r\nimport AppForm from '../components/app-form/app-form';\r\nimport { requestPasswordResetCode } from '../services/user/actions';\r\n\r\nimport styles from './index.module.css';\r\n\r\nimport { useAppSelector, useAppDispatch } from '../services/types';\r\n\r\nconst ForgotPasswordPage = (): React.ReactElement | null => {\r\n\r\n    const dispatch = useAppDispatch();\r\n    const { passwordResetCodeSuccess } = useAppSelector(store => store.user);\r\n    const history = useHistory();\r\n    const [email, setEmail] = React.useState('');\r\n\r\n    React.useEffect( () => {\r\n        if(passwordResetCodeSuccess) {\r\n            history.replace({pathname: '/reset-password'});\r\n        }\r\n    }, [passwordResetCodeSuccess, history]);\r\n\r\n    const onEmailUpdate = (e: React.SyntheticEvent) => {\r\n        setEmail((e.target as HTMLInputElement).value);\r\n    };\r\n\r\n    const handleRestoreEmail = (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n        dispatch(requestPasswordResetCode(email));\r\n    };\r\n\r\n    return (\r\n        <AppForm title='Восстановление пароля' onSubmit={ handleRestoreEmail }>\r\n            <div className={styles.input}>\r\n                <Input \r\n                type = \"email\"\r\n                name={'email'} \r\n                placeholder={'Укажите e-mail'} \r\n                onChange={onEmailUpdate}\r\n                value={email} />\r\n            </div>\r\n            <div className={styles.button}>\r\n                <Button>Восстановить</Button >\r\n            </div>\r\n\r\n            <p className={styles.helpRedirect}>\r\n                Вспомнили пароль? \r\n                <Link to='/login' className={styles.link}>Войти</Link> \r\n            </p>\r\n\r\n        </AppForm>\r\n    );\r\n}\r\n\r\nexport default ForgotPasswordPage;\r\n","import React from 'react';\r\nimport { Link, useHistory } from 'react-router-dom';\r\nimport {PasswordInput, Input, Button} from '@ya.praktikum/react-developer-burger-ui-components';\r\n\r\nimport AppForm from '../components/app-form/app-form';\r\nimport { resetPassword } from '../services/user/actions';\r\n\r\nimport styles from './index.module.css';\r\n\r\nimport { useAppDispatch, useAppSelector } from '../services/types';\r\n\r\nfunction ResetPasswordPage() {\r\n\r\n    const history = useHistory();\r\n    const dispatch = useAppDispatch();\r\n    const { passwordResetCodeSuccess, passwordResetSuccess } = useAppSelector(store => store.user);\r\n    const [resetData, setResetData] = React.useState({password: '', verificationToken: ''});\r\n\r\n    React.useEffect( () => {\r\n        if(!passwordResetCodeSuccess) {\r\n            history.replace({pathname: './forgot-password'});\r\n        } else if(passwordResetSuccess) {\r\n            history.replace({pathname: './login'});\r\n        }\r\n\r\n    }, \r\n    [passwordResetCodeSuccess, passwordResetSuccess,  history]);\r\n\r\n    const onChange = (e: React.ChangeEvent) => {\r\n        const name = (e.target as HTMLInputElement).name;\r\n        const value = (e.target as HTMLInputElement).value;\r\n        setResetData({...resetData, [name]: value});\r\n    }\r\n\r\n    const handleResetPassword = (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n        dispatch(resetPassword(resetData.password, resetData.verificationToken));\r\n    }\r\n\r\n    return (\r\n        <AppForm title='Восстановление пароля' onSubmit={handleResetPassword}>\r\n            <div className={styles.input}>\r\n                <PasswordInput onChange={onChange} name={'password'} value={resetData.password}/>\r\n            </div>\r\n            <div className={styles.input}>\r\n                <Input\r\n                type=\"text\" \r\n                onChange={onChange} \r\n                name={'verificationToken'} \r\n                placeholder={'Введите код из письма'} \r\n                value={resetData.verificationToken}/>\r\n            </div>\r\n            <div className={styles.button}>\r\n                <Button>Сохранить</Button >\r\n            </div>\r\n\r\n            <p className={styles.helpRedirect}>\r\n                Вспомнили пароль? \r\n                <Link to='/login' className={styles.link}>Войти</Link> \r\n            </p>\r\n\r\n        </AppForm>\r\n    );\r\n}\r\n\r\nexport default ResetPasswordPage;\r\n","import React from 'react';\r\nimport {Input, Button} from '@ya.praktikum/react-developer-burger-ui-components';\r\n\r\nimport styles from '../../pages/index.module.css'\r\nimport profileStyles from './profile-settings.module.css'\r\nimport { updateUser } from '../../services/user/actions';\r\n\r\nimport { useAppSelector, useAppDispatch } from '../../services/types';\r\n\r\nconst PASSWORD_PLACEHOLDER = '******';\r\n\r\ninterface IUserInfo {\r\n    name: string;\r\n    email: string;\r\n    password: string;\r\n}\r\n\r\ninterface IUserInfoOptionalPassword {\r\n    name: string;\r\n    email: string;\r\n    password?: string;\r\n}\r\n\r\nfunction ProfileSettings() {    \r\n\r\n    const dispatch = useAppDispatch();\r\n    const {name, email} = useAppSelector( store => store.user);\r\n\r\n    //these are not application level data, therefore don't create separate action and reducer\r\n    const [user, setUser] = React.useState<IUserInfo>({name: name, email: email, password: PASSWORD_PLACEHOLDER});\r\n\r\n    const updateField = (e: React.ChangeEvent) => {\r\n        const elem = e.target as HTMLInputElement;\r\n        setUser({...user, [elem.name]: elem.value});\r\n    }\r\n    \r\n    const saveChanges = (e: React.SyntheticEvent) => {\r\n        e.preventDefault();\r\n\r\n        const updatedFields: IUserInfoOptionalPassword = {name: user.name, email: user.email};\r\n\r\n        if(user.password && user.password.indexOf('*') < 0) {\r\n            updatedFields.password = user.password;\r\n        }\r\n        dispatch(updateUser(updatedFields));\r\n        setUser( prevState => ({...prevState , password: PASSWORD_PLACEHOLDER}))\r\n    }\r\n\r\n    const cancelChanges = (e: React.SyntheticEvent) => {\r\n        e.preventDefault();\r\n        setUser({name: name, email: email, password: PASSWORD_PLACEHOLDER});\r\n    }\r\n\r\n    return (\r\n        <article>\r\n            <div className={styles.input}>\r\n                <Input \r\n                    type=\"text\" \r\n                    onChange = {updateField}\r\n                    name={'name'} \r\n                    placeholder={'Имя'} \r\n                    icon={'EditIcon'} \r\n                    value={user.name}/>\r\n            </div>\r\n            <div className={styles.input}>\r\n                <Input \r\n                    name={'email'} \r\n                    onChange = {updateField}\r\n                    icon={'EditIcon'} \r\n                    value={user.email}/>\r\n            </div>\r\n            <div className={styles.input}>\r\n                <Input \r\n                    name={'password'} \r\n                    onChange = {updateField}\r\n                    placeholder={'Пароль'} \r\n                    icon={'EditIcon'}\r\n                    value={user.password}/>\r\n            </div>\r\n            <div className={profileStyles.buttonsArea}>\r\n                <Button type=\"primary\" size=\"medium\" onClick={saveChanges}> Сохранить </Button>\r\n                <div className={profileStyles.buttonSeparator}> </div>\r\n                <Button type=\"primary\" size=\"medium\" onClick={cancelChanges}> Отмена </Button>\r\n            </div>\r\n        </article>\r\n    );\r\n}\r\n\r\nexport default ProfileSettings;\r\n","import React, {FC} from 'react';\r\n\r\nimport {CurrencyIcon}  from '@ya.praktikum/react-developer-burger-ui-components';\r\nimport styles from './price.module.css';\r\n\r\nexport type IPrice = {\r\n    price: number | string;\r\n}\r\n\r\nconst Price: FC<IPrice> = ({price}) => {\r\n\r\n    return (\r\n        <div className={styles.price}> <span  className={styles.price_num}>{price}</span> <CurrencyIcon type=\"primary\"/> </div>\r\n    ); \r\n}\r\n\r\nexport default Price;","import {FC} from 'react';\r\nimport styles from './ingredient-icon-round.module.css';\r\n\r\ninterface IIngredientIconRoundProps {\r\n    image_mobile: string,\r\n    name: string,\r\n    customStyle: object\r\n}\r\n\r\nconst IngredientIconRound: FC<IIngredientIconRoundProps> = ({image_mobile, name, customStyle}) => {\r\n\r\n    return  <span className={styles.ingredientContainer} style = {customStyle} >\r\n                <img src = {image_mobile} alt = {name}  className={styles.ingredientImg}/>\r\n            </span>\r\n\r\n} \r\n\r\nexport default IngredientIconRound\r\n\r\n\r\n","const translationsRU = {\r\n    'today': 'Сегодня',\r\n    'yesterday': 'Вчера',\r\n    'lessThanFiveDaysAgo': 'дня назад',\r\n    'daysAgo': 'дней назад'\r\n}\r\n\r\nexport default translationsRU;","import translationsRU from \"../vocabulary/ru\";\r\n\r\nexport const MILLISECONDS_IN_HOUR = 60*60*1000;\r\nexport const MILLISECONDS_IN_DAY = 24*MILLISECONDS_IN_HOUR;\r\n\r\nexport class DateFormatter {\r\n\r\n    static getDate = (dateValue: string):Date => {\r\n        const date = new Date(dateValue);\r\n\r\n        if(!date) {\r\n            throw new Error(`Date couldn't be recognized: ${dateValue}`);\r\n        }\r\n\r\n        return date;\r\n    }\r\n\r\n    static getTime = (date: Date): string => {\r\n        const minutes = date.getMinutes();\r\n        return `${date.getHours()}:${minutes < 10 ? '0' + minutes : minutes}`;\r\n    }\r\n\r\n    static getTZ = (date: Date):string => {\r\n        const offsetInHours = date.getTimezoneOffset()/60;\r\n        return `i-GMT${offsetInHours < 0 ? '+' : '-'}${Math.abs(offsetInHours)}`;\r\n    }\r\n\r\n    static getDaysDiff = (date: Date):string => {\r\n\r\n        const now = new Date();\r\n\r\n        const cleanDate = new Date(date);\r\n        cleanDate.setHours(0,0,0,0);\r\n\r\n        const cleanNow = new Date(now);        \r\n        cleanNow.setHours(0,0,0,0);\r\n\r\n        const diffInDays = (cleanNow.getTime() - cleanDate.getTime())/MILLISECONDS_IN_DAY;\r\n\r\n        if(diffInDays > 7) {\r\n            return cleanDate.getDate()+' '+cleanDate.getMonth()+' '+cleanDate.getFullYear();\r\n        }\r\n\r\n        if(diffInDays === 0) {            \r\n            return translationsRU['today'];\r\n        }\r\n\r\n        if(diffInDays === 1) {            \r\n            return translationsRU['yesterday'];\r\n        }\r\n\r\n        if( diffInDays < 5  ) {\r\n            return diffInDays+' '+translationsRU['lessThanFiveDaysAgo'];\r\n        }\r\n\r\n        return diffInDays+' '+translationsRU['daysAgo'];\r\n\r\n    }\r\n    \r\n    static getRelativeFormat = (dateValue: string) => {\r\n        const date = DateFormatter.getDate(dateValue);\r\n        return DateFormatter.getDaysDiff(date)+', '+DateFormatter.getTime(date)+' '+DateFormatter.getTZ(date);\r\n    }\r\n}","//TODO: create class for order\r\n\r\nexport const formatOrderNumber = (num: number): string => {\r\n    const MAX_CHART_NUM = 5;\r\n    const number = String(num);\r\n    const leadingZeroCount = MAX_CHART_NUM - number.length;\r\n    let prefix = '';\r\n    while(prefix.length < leadingZeroCount) {\r\n        prefix += '0';\r\n    }\r\n    return prefix+number;\r\n}","import React, {FC} from 'react';\r\n\r\nimport Price from '../price/price';\r\nimport IngredientIconRound from '../ingredient-icon-round/ingredient-icon-round';\r\nimport { DateFormatter } from '../../utils/date-formatter/date-formatter';\r\nimport { formatOrderNumber } from '../utils/order';\r\n\r\nimport styles from './order-card.module.css';\r\n\r\nimport { useAppSelector } from '../../services/types';\r\nimport {TOrder, TIngredient} from '../../services/types/index';\r\n\r\ninterface IOrderCardProps {\r\n    data: TOrder; \r\n    openModal: (_id: string) => void;\r\n}\r\n\r\nconst OrderCard: FC<IOrderCardProps> = ({data: {_id, updatedAt, name, ingredients, number}, openModal }) => {\r\n\r\n    const ingredientsData = useAppSelector(store => store.ingredients.items);\r\n    const numOfIngredientsInOrder = ingredients.length;\r\n    const MAX_NUM_OF_VISIBLE_ITEMS = 5;\r\n\r\n    const drawIngredientImage = (item: TIngredient, index: number) => {\r\n\r\n        const SHIFT_OF_IMAGES_PX = 50;\r\n\r\n        if(index < MAX_NUM_OF_VISIBLE_ITEMS) { \r\n            return (\r\n                <IngredientIconRound \r\n                key = {index} \r\n                image_mobile = {item.image_mobile}\r\n                name = {item.name}\r\n                customStyle={{\r\n                    left: `${index*SHIFT_OF_IMAGES_PX}px`,\r\n                    zIndex: (numOfIngredientsInOrder - index)\r\n                }}/>\r\n                \r\n                \r\n            );\r\n        } else {\r\n            return (\r\n                <span key = {index} className = {styles.hiddenIngredientsReplacement}\r\n                    style = {{\r\n                        left: `${(index-1)*SHIFT_OF_IMAGES_PX}px`,\r\n                        zIndex: (numOfIngredientsInOrder - index+1)\r\n                    }}\r\n                >\r\n                    {`+${numOfIngredientsInOrder - MAX_NUM_OF_VISIBLE_ITEMS}`}\r\n                </span>\r\n            )\r\n        }      \r\n    }\r\n\r\n    const images = ingredientsData\r\n                    .filter( item => ingredients.indexOf(item._id) >= 0) \r\n                    .filter( (item, index) => index <= MAX_NUM_OF_VISIBLE_ITEMS ) // = means add extra placeholder for \"hidden\" ingredients\r\n                    .map(drawIngredientImage);\r\n\r\n    const price = ingredientsData\r\n                    .filter( item => ingredients.indexOf(item._id) >= 0)\r\n                    .reduce( (sum, ingredient) => (sum += ingredient.price), 0);\r\n\r\n\r\n    const openOrderInfo = (e: React.MouseEvent) => {\r\n        const elem = e.target as Element;\r\n        if(elem.nodeName !== 'BUTTON') {\r\n            openModal(_id);\r\n        }\r\n    }\r\n\r\n    return (\r\n        \r\n        <article className={styles.card} onClick={openOrderInfo}>              \r\n            <p className={styles.topInfo}>\r\n                <span className={styles.id}>{`#${formatOrderNumber(number)}`}</span>\r\n                <span className={styles.timestamp}>{DateFormatter.getRelativeFormat(updatedAt)}</span>\r\n            </p>           \r\n            <header className={styles.title}> {name} </header> \r\n            <div className={styles.bottomInfo}>\r\n                <div className={styles.ingredients}>{images}</div>\r\n                <Price price={price}/>\r\n            </div>          \r\n        </article>\r\n  \r\n    ); \r\n}\r\n\r\nexport default OrderCard;","import React, { useState, FC } from 'react';\r\nimport {useRouteMatch, Link, useLocation, useHistory} from 'react-router-dom';\r\n\r\nimport styles from './feed-list.module.css';\r\nimport OrderCard from '../order-card/order-card';\r\nimport { OrderInfoPage } from '../../pages';\r\nimport Modal from '../modal/modal';\r\n\r\nimport { TOrder } from '../../services/types/index';\r\n\r\ninterface IFeedListProps {\r\n    owner?: 'profile';\r\n    data: { \r\n        orders: Array<TOrder>\r\n    }\r\n}\r\n\r\nconst FeedList: FC<IFeedListProps> = ({owner, data}) => {\r\n\r\n    const [showOrderInfo, setShowOrderInfo] = useState(false);\r\n    const [activeOrder, setActiveOrder] = useState<string | null>(null);\r\n\r\n    const orders = data.orders;\r\n    \r\n    const {url} = useRouteMatch();\r\n    const location = useLocation();\r\n    const history = useHistory();\r\n    const fallbackMsg = owner ==='profile' ? 'Вы ещё ничего не заказывали' : 'Грузим данные';\r\n    \r\n    const openModal = (id: string) => {\r\n        setShowOrderInfo(true);\r\n        setActiveOrder(id);\r\n    }\r\n\r\n    const closeModal = (e: React.MouseEvent | React.KeyboardEvent) => {\r\n        e.stopPropagation();\r\n        setShowOrderInfo(false);\r\n        setActiveOrder(null);\r\n        history.goBack();\r\n    }\r\n    \r\n    return (\r\n        <article className={owner==='profile' ? styles.orders__profile  : styles.orders}>\r\n            { \r\n            orders.length > 0 ? \r\n            orders.map( order => ( \r\n                <Link key = {order._id} to={{ pathname: `${url}/${order._id}`, state: { background: location } }} className={styles.link} >\r\n                    <OrderCard data = {order} openModal={openModal}/> \r\n                </Link>\r\n            )) \r\n            : <p>{ fallbackMsg }</p>\r\n            }\r\n\r\n            { showOrderInfo && \r\n                <Modal type=\"orderInfo\" onClose={closeModal} > \r\n                    <OrderInfoPage activeOrder={activeOrder} />\r\n                </Modal> \r\n            }   \r\n            \r\n        </article>   \r\n    ); \r\n}\r\n\r\nexport default FeedList;\r\n","import React from 'react';\r\nimport { Switch, NavLink, useLocation } from 'react-router-dom';\r\nimport ProfileSettings from '../components/profile-settings/profile-settings';\r\n\r\nimport AppForm from '../components/app-form/app-form';\r\nimport FeedList from '../components/feed-list/feed-list';\r\nimport RouteForAuthorizedUsers from '../components/route-auth-users/route-auth-users';\r\nimport { logout} from '../services/user/actions';\r\nimport { socketType } from '../utils/constants';\r\n\r\nimport styles from './profile.module.css';\r\n\r\nimport { useAppSelector, useAppDispatch } from '../services/types';\r\n\r\nconst ProfilePage = () => { \r\n    \r\n    const dispatch = useAppDispatch();\r\n    const {loginSuccess} = useAppSelector(store => store.user); \r\n    const {data} = useAppSelector( store => store.orders[socketType.personalOrders]);\r\n\r\n    const {pathname} = useLocation();\r\n        \r\n    const profileMenuItems = React.useMemo( () => { \r\n\r\n        const exitHandler = (e: React.MouseEvent) => {\r\n            e.preventDefault();\r\n            dispatch(logout());\r\n        };\r\n\r\n        return [\r\n            {to: '/profile', label: 'Профиль', infoText: 'В этом разделе вы можете изменить свои персональные данные'},\r\n            {to: '/profile/orders', label: 'История заказов', infoText: 'В этом разделе вы можете просмотреть свою историю заказов'},\r\n            {to: '', onClickHandler: exitHandler, label: 'Выход'}\r\n        ]\r\n    }, \r\n    [dispatch]);\r\n    \r\n    const infoText = React.useMemo( () => {\r\n        const currentMenuItem = profileMenuItems.find( item => item.to === pathname);\r\n        return currentMenuItem ? currentMenuItem.infoText : '';\r\n    }, \r\n    [pathname, profileMenuItems]);\r\n\r\n\r\n    return (\r\n        <>\r\n        { loginSuccess && <AppForm additionalStyles={['profileForm']}>\r\n\r\n                <section className={styles.profileNav}>\r\n                    <ul>\r\n                        {\r\n                        profileMenuItems.map( (item, index) => (\r\n                            <li key={index}>\r\n                                <NavLink \r\n                                to={item.to} \r\n                                exact \r\n                                onClick={item.onClickHandler}\r\n                                className={styles.profileNavItem} \r\n                                activeClassName=\"nav_link-active\"> {item.label} </NavLink>\r\n                                </li>\r\n                        )) \r\n                        }\r\n                    </ul>\r\n                    <p className={styles.profileInfo}>{infoText}</p>\r\n                </section>\r\n\r\n                <section>\r\n                    <Switch>\r\n                        {data && <RouteForAuthorizedUsers exact path='/profile/orders'> <FeedList owner={'profile'} data={data}/> </RouteForAuthorizedUsers> }\r\n                        <RouteForAuthorizedUsers exact path='/profile'> <ProfileSettings /> </RouteForAuthorizedUsers>\r\n                    </Switch>                    \r\n                </section>\r\n\r\n            </AppForm>\r\n        }\r\n        </>\r\n    );\r\n}\r\n\r\nexport default ProfilePage;\r\n","function NotFoundPage() { \r\n\r\n    return (\r\n        <p> 404 Not Found</p>\r\n    );\r\n}\r\n\r\nexport default NotFoundPage;\r\n","import { FC } from 'react'; \r\nimport styles from './orderid-list.module.css'\r\nimport { formatOrderNumber } from '../../utils/order';\r\nimport { TOrder } from '../../../services/types/index';\r\n\r\ninterface IOrderIDListProps {\r\n    orders: Array<TOrder>;\r\n    title: string;\r\n    type?: 'green';\r\n}\r\n\r\nconst OrderIDList: FC<IOrderIDListProps> = ({orders, title, type}) => {\r\n\r\n    const drawOrderItem = (item:TOrder) => ( <li key={item._id} className={styles.listItem}>{formatOrderNumber(item.number)}</li> );\r\n\r\n    return  (\r\n        <section className={styles.orderList}> \r\n            <header className={styles.listTitle}>{title}</header>\r\n            <ul className={styles[`itemColor_${type}`]}>\r\n                {\r\n                    orders.map(drawOrderItem)\r\n                }\r\n            </ul>\r\n        </section>\r\n    )\r\n}\r\n\r\n\r\nexport default OrderIDList;","import { FC } from 'react'; \r\nimport styles from './feed-info.module.css';\r\n\r\ninterface IFeedInfoProps {\r\n    label: string;\r\n    value: number;\r\n}\r\n\r\nconst FeedInfo: FC<IFeedInfoProps> = ({label, value}) => {\r\n\r\n    return  (\r\n        <section >\r\n            <header className={styles.label}>{label}</header>\r\n            <span className={styles.value}>{value}</span>\r\n        </section>\r\n    )\r\n}\r\n\r\n\r\nexport default FeedInfo;\r\n\r\n","import React from 'react';\r\n\r\nimport OrderIDList from './orderid-list/order-id-list';\r\nimport FeedInfo from './feed-info/feed-info';\r\nimport { socketType } from '../../utils/constants';\r\n\r\nimport styles from './feed-overview.module.css';\r\n\r\nimport { useAppSelector } from '../../services/types';\r\nimport { TOrder } from '../../services/types/index';\r\n\r\nconst MAX_NUM_OF_VISIBLE_ORDERS = 10;\r\n\r\nconst FeedOverview = () => {\r\n\r\n    const {data} = useAppSelector( store => store.orders[socketType.allOrders]);\r\n\r\n    const orders = (data && data.orders) || [];\r\n    const total = (data && data.total) || 0;\r\n    const totalToday = (data && data.totalToday) || 0;\r\n  \r\n    const readyOrders = orders.filter( (item: TOrder, index: number) => item.status === \"done\" && index < MAX_NUM_OF_VISIBLE_ORDERS);\r\n    const inProgressOrders = orders.filter( (item: TOrder, index: number) => item.status === \"inprogress\" && index < MAX_NUM_OF_VISIBLE_ORDERS);\r\n\r\n    return (\r\n\r\n        <section className={styles.overview}>\r\n            \r\n            <article className={styles.content}>\r\n\r\n                <div className={styles.contentRow}>                \r\n                    <div className={styles.contentRow__item}> <OrderIDList orders={readyOrders} title={'Готовы'} type={'green'}/> </div>\r\n                    <div className={styles.contentRow__item}> <OrderIDList orders={inProgressOrders} title={'В работе'} /> </div>\r\n                </div>\r\n\r\n                <div className={styles.contentRow}> <FeedInfo label={'Выполнено за все время:'} value={total}/> </div>\r\n                <div className={styles.contentRow}> <FeedInfo label={'Выполнено за сегодня:'} value={totalToday}/> </div>\r\n\r\n            </article>\r\n            \r\n        </section>   \r\n    ); \r\n}\r\n\r\nexport default FeedOverview;\r\n\r\n","import React from 'react';\r\n\r\nimport FeedList from '../components/feed-list/feed-list';\r\nimport FeedOverview from '../components/feed-overview/feed-overview';\r\nimport { socketType } from '../utils/constants';\r\n\r\nimport styles from './feed.module.css';\r\n\r\nimport { useAppSelector } from '../services/types';\r\n\r\nconst FeedPage = (): React.ReactElement | null => {\r\n\r\n    const {data} = useAppSelector( store => store.orders[socketType.allOrders]);\r\n\r\n    return (\r\n        <>\r\n        { data ? \r\n                <article className={styles.page}>\r\n                    <header> \r\n                        <h2 className={styles.title}>Лента заказов</h2> \r\n                    </header> \r\n\r\n                    <section className={styles.contentArea}>\r\n                        <FeedList data={data}/>\r\n                        <FeedOverview />\r\n                    </section>\r\n                </article>\r\n            \r\n            : <></>\r\n        }\r\n        </>   \r\n    );\r\n}\r\n\r\nexport default FeedPage;\r\n","import { FC } from 'react';\r\nimport { useParams, useLocation } from 'react-router-dom';\r\n\r\nimport styles from './order-info.module.css'\r\nimport { formatOrderNumber } from '../components/utils/order';\r\nimport { DateFormatter } from '../utils/date-formatter/date-formatter';\r\nimport { socketType } from '../utils/constants';\r\n\r\nimport Price from '../components/price/price';\r\nimport IngredientIconRound from '../components/ingredient-icon-round/ingredient-icon-round';\r\nimport { useAppSelector } from '../services/types';\r\n\r\nimport { TOrder, TIngredient } from '../services/types';\r\n\r\nconst orderStatusTranslations: {[name:string]: string} = \r\n                                { done: 'Выполнен', \r\n                                  inprogress: 'В работе',\r\n                                  cancelled: 'Отменён'\r\n                                };\r\n\r\ninterface IOrderInfoPageProps {\r\n    activeOrder?: string | null; \r\n}\r\n\r\nconst OrderInfoPage: FC<IOrderInfoPageProps> = ({activeOrder}) => { \r\n\r\n    let {id} = useParams<{id: string | undefined}>();\r\n    const location = useLocation();    \r\n    const ingredientsData = useAppSelector(store => store.ingredients.items);\r\n    const {data} = useAppSelector( store => store.orders[location.pathname.indexOf('/feed')>=0 ? socketType.allOrders : socketType.personalOrders]);\r\n    const orders = data && data.orders;\r\n\r\n    if(!orders) {\r\n        return <>Loading</>;\r\n    }\r\n\r\n    if((id ===null || id === undefined) && activeOrder) {\r\n        id = activeOrder;\r\n    }\r\n\r\n    const [order] = orders.filter( (item:TOrder) => item._id === id);\r\n\r\n    const getOrderContent = (ingredientsData: TIngredient[], order:TOrder) => {\r\n\r\n        const ingredientsInOrder = ingredientsData.filter( (item:TIngredient) => order.ingredients.indexOf(item._id) >= 0);\r\n        const ingredientCounts = order.ingredients.reduce( (counts: {[name: string] : number}, item: string) => {\r\n                                                                if(counts.hasOwnProperty(item)) {\r\n                                                                    counts[item] += 1;\r\n                                                                } else {\r\n                                                                    counts[item] = 1;\r\n                                                                }\r\n                                                                return counts;\r\n                                                            }, {});\r\n        return ingredientsInOrder.map( (item) => (\r\n                    <li key={item._id} className={styles.ingredientInOrder}>\r\n                        <IngredientIconRound name={item.name} image_mobile={item.image_mobile} customStyle={{position:'relative'}}/>\r\n                            <span className={styles.ingredientInOrderName}> {item.name} </span>\r\n                            <Price price={`${ingredientCounts[item._id]} x ${item.price}`}/>\r\n                    </li>\r\n                ));\r\n    }\r\n                                    \r\n    const price = ingredientsData\r\n                    .filter( item => order.ingredients.indexOf(item._id) >= 0)\r\n                    .reduce( (sum, ingredient) => (sum += ingredient.price), 0);\r\n\r\n    return (\r\n        <article className={activeOrder ? styles.cardInModal : styles.card}>\r\n            <header>\r\n                <p className={styles.id}>{`#${formatOrderNumber(order.number)}`}</p>\r\n                <h2 className={styles.title}> {order.name} </h2>\r\n                <p className={styles[`status_${order.status}`]}> {orderStatusTranslations[order.status]} </p>\r\n            </header>\r\n\r\n            <section className={styles.content}>\r\n                <p className={styles.contentTitle}>Состав:</p>\r\n                <ul className={styles.ingredients}> { getOrderContent(ingredientsData, order) } </ul>\r\n            </section>\r\n\r\n            <footer className={styles.footer}>\r\n                <span className={styles.timestamp}>{DateFormatter.getRelativeFormat(order.updatedAt)}</span>\r\n                <Price price={price}/>\r\n            </footer>\r\n            \r\n        </article>\r\n    );\r\n}\r\n\r\nexport default OrderInfoPage;","import React from 'react';\r\nimport { Route, Switch, useLocation, useHistory } from 'react-router-dom';\r\n\r\nimport { useAppSelector, useAppDispatch } from '../../services/types';\r\n\r\nimport './app.css';\r\n\r\nimport AppHeader from '../app-header/app-header';\r\nimport RouteForAuthorizedUsers from '../route-auth-users/route-auth-users';\r\nimport RouteForUnauthorizedUsers from '../route-unauth-users/route-unauth-users';\r\nimport { MainPage, LoginPage, RegisterPage, ForgotPasswordPage, ResetPasswordPage, ProfilePage, FeedPage, NotFoundPage, OrderInfoPage } from '../../pages';\r\nimport IngredientDetails from '../ingredient-details/ingredient-details';\r\n\r\nimport { getIngredientData } from '../../services/ingredients/actions';\r\nimport { refreshUser } from '../../services/user/actions';\r\nimport { ActionTypes } from '../../services/actionTypes';\r\nimport { ILocation } from '../../services/types';\r\n\r\n\r\nfunction App() {\r\n\r\n  const dispatch = useAppDispatch();  \r\n  const { ingredientsLoadSuccess } = useAppSelector(store => store.ingredients);\r\n  const { loginSuccess } = useAppSelector(store => store.user);\r\n\r\n  const location = useLocation<ILocation>();\r\n  const history = useHistory();\r\n  const background = history.action === 'PUSH' && location.state && location.state.background;\r\n\r\n  React.useEffect( () => {\r\n    dispatch(getIngredientData());\r\n    dispatch(refreshUser());\r\n    dispatch({type: ActionTypes.wsAllOrders.wsInit}); \r\n    \r\n  },[dispatch]); \r\n\r\n  React.useEffect( () => {\r\n    if(loginSuccess) {\r\n      dispatch({type: ActionTypes.wsUserOrders.wsInit});\r\n    }     \r\n  },[dispatch, loginSuccess]); \r\n\r\n\r\n  if(!ingredientsLoadSuccess) {\r\n    return <p> Данные загружаются </p>;\r\n  }\r\n \r\n  return (\r\n\r\n    <>\r\n      <AppHeader />\r\n      <main>\r\n        <Switch location={background || location}>\r\n\r\n          <Route exact path='/'> <MainPage /> </Route>\r\n          <Route exact path='/ingredients/:id' > <IngredientDetails /> </Route>  \r\n          <Route exact path='/feed/:id' > <OrderInfoPage /> </Route>\r\n\r\n          <Route exact path='/feed' > <FeedPage /> </Route> \r\n          <RouteForAuthorizedUsers   exact path='/profile/orders/:id' > <OrderInfoPage /> </RouteForAuthorizedUsers>\r\n          <RouteForAuthorizedUsers   path='/profile' > <ProfilePage /> </RouteForAuthorizedUsers> \r\n\r\n          <RouteForUnauthorizedUsers exact path='/login' > <LoginPage /> </RouteForUnauthorizedUsers> \r\n          <RouteForUnauthorizedUsers exact path='/register' > <RegisterPage /> </RouteForUnauthorizedUsers> \r\n          <RouteForUnauthorizedUsers exact path='/forgot-password' > <ForgotPasswordPage /> </RouteForUnauthorizedUsers> \r\n          <RouteForUnauthorizedUsers exact path='/reset-password' > <ResetPasswordPage /> </RouteForUnauthorizedUsers> \r\n    \r\n          <Route path='/notfound'> <NotFoundPage /> </Route>\r\n\r\n        </Switch>\r\n\r\n      </main>\r\n    </>\r\n\r\n  );\r\n}\r\n\r\nexport default App;\r\n","import {dataUrl} from '../../utils/constants';\r\n//import {ingredients} from '../utils/data'\r\n\r\nimport {ActionTypes} from '../actionTypes';\r\nimport { TIngredient } from '../types';\r\nimport { AppThunk, AppDispatch } from '../types';\r\n\r\nexport interface IGetIngredientsRequest {\r\n    readonly type: typeof ActionTypes.GET_INGREDIENTS_REQUEST;\r\n}\r\n\r\nexport interface IGetIngredientsSuccess {\r\n    readonly type: typeof ActionTypes.GET_INGREDIENTS_SUCCESS;\r\n    readonly data: Array<TIngredient>;\r\n}\r\n\r\nexport interface IGetIngredientsFailed {\r\n    readonly type: typeof ActionTypes.GET_INGREDIENTS_FAILED;\r\n}\r\n\r\nexport interface IShowIngredientsDetails {\r\n    readonly type: typeof ActionTypes.SHOW_INGREDIENT_DETAILS;\r\n    readonly value: boolean;\r\n}\r\n\r\nexport interface ISetActiveIngredient {\r\n    readonly type: typeof ActionTypes.SET_ACTIVE_INGREDIENT;\r\n    readonly value: TIngredient;\r\n}\r\n\r\nexport type TIngredientActions = \r\n| IGetIngredientsRequest\r\n| IGetIngredientsSuccess\r\n| IGetIngredientsFailed\r\n| IShowIngredientsDetails\r\n| ISetActiveIngredient;\r\n\r\n\r\nexport const getIngredientData: AppThunk = () => {\r\n\r\n    return (dispatch: AppDispatch) => {\r\n\r\n        dispatch({type: ActionTypes.GET_INGREDIENTS_REQUEST});\r\n\r\n        fetch(dataUrl)\r\n        .then(res => res.ok ? res.json() : Promise.reject(res.statusText))\r\n        .then(res => {\r\n            dispatch({type:  ActionTypes.GET_INGREDIENTS_SUCCESS, data: res.data});\r\n        })\r\n        .catch( e => {\r\n            dispatch({type:  ActionTypes.GET_INGREDIENTS_FAILED});     \r\n        });\r\n\r\n    }\r\n};\r\n\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport { Provider } from 'react-redux';\r\nimport { BrowserRouter } from 'react-router-dom';\r\nimport reportWebVitals from './reportWebVitals';\r\n\r\nimport './index.css';\r\nimport { store } from './services/store';\r\nimport App from './components/app/app';\r\n\r\nconst baseUrl = process.env.NODE_ENV === 'development' ? '/' : '/react-burger'\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <Provider store={store}>\r\n      <BrowserRouter basename={baseUrl}>\r\n        <App />\r\n      </BrowserRouter>\r\n    </Provider>\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\n\r\nreportWebVitals();\r\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"card\":\"order-card_card__175v_ p-6 mb-4\",\"topInfo\":\"order-card_topInfo__1A2ik\",\"bottomInfo\":\"order-card_bottomInfo__2rF-X\",\"id\":\"order-card_id__kLSxL text text_type_main-default\",\"timestamp\":\"order-card_timestamp__FMQlz text text_type_main-default\",\"title\":\"order-card_title__2xCLX mt-6 mb-6 text text_type_main-default\",\"ingredients\":\"order-card_ingredients__3Sefe\",\"hiddenIngredientsReplacement\":\"order-card_hiddenIngredientsReplacement__jjqBO text text_type_main-default\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"details_section\":\"ingredient-details_details_section__3Cbkv pt-10 pr-10 pb-15 pl-10\",\"details_header\":\"ingredient-details_details_header__3AXfj text text_type_main-large\",\"details_title\":\"ingredient-details_details_title__3GO_I pt-4 pb-8 text text_type_main-medium\",\"nutrition_info\":\"ingredient-details_nutrition_info__38kS9 text text_type_main-default text_color_inactive\",\"nutrition_item\":\"ingredient-details_nutrition_item__1fu_K mr-5\",\"nutrition_val\":\"ingredient-details_nutrition_val__3OptT text text_type_digits-default\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"overview\":\"feed-overview_overview__3gVzS ml-5 mr-5 pr-2\",\"allOrdersSection\":\"feed-overview_allOrdersSection__2lOqH pt-15 pb-15\",\"contentRow\":\"feed-overview_contentRow__3Prv0 mb-15\",\"contentRow__item\":\"feed-overview_contentRow__item__2ZeEs pr-9\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"card\":\"ingredient_card__2qFBx pl-4 mb-8 mr-3\",\"image\":\"ingredient_image__M-Bt8 mr-4 ml-4\",\"price\":\"ingredient_price__2Hhk1 pt-1 pb-1\",\"price_num\":\"ingredient_price_num__3aZ16 pr-1 text text_type_digits-default\",\"name\":\"ingredient_name__273ZL text text_type_main-default\",\"add_btn\":\"ingredient_add_btn__1D5Qp\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"info_section\":\"order-details_info_section__29AgM mt-30 mb-30\",\"orderId\":\"order-details_orderId__3wL5c text text_type_digits-large pr-25 pl-25\",\"orderId_note\":\"order-details_orderId_note__3dDP9 text text_type_main-default pt-8 pb-15\",\"common_notes_main\":\"order-details_common_notes_main__2dFTI pt-15 pb-2 text text_type_main-default\",\"common_notes_sec\":\"order-details_common_notes_sec__3KIhB text text_type_main-default text_color_inactive\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"nav_item\":\"nav-item_nav_item__2nfy_ text text_type_main-default pl-5 pr-5 mt-4 mb-4\",\"profile_item\":\"nav-item_profile_item__l3Yhz nav-item_nav_item__2nfy_ text text_type_main-default pl-5 pr-5 mt-4 mb-4\",\"logo_desktop_item\":\"nav-item_logo_desktop_item__1nH6W nav-item_nav_item__2nfy_ text text_type_main-default pl-5 pr-5 mt-4 mb-4\",\"nav_link\":\"nav-item_nav_link__1b7ij\",\"nav_link_active\":\"nav-item_nav_link_active__p3un8 nav-item_nav_link__1b7ij\",\"link_text\":\"nav-item_link_text__vPgPA pl-2\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"constructor_area\":\"burger-constructor_constructor_area__2tkO6 pt-25 ml-5 mr-5\",\"main_area\":\"burger-constructor_main_area__1SztS\",\"emptyConstructor\":\"burger-constructor_emptyConstructor__3CsIW m-10 p-10 text text_type_main-default\",\"scrollable_area\":\"burger-constructor_scrollable_area__2Hv6d burger-constructor_main_area__1SztS pr-2\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"listTitle\":\"orderid-list_listTitle__3h7pB text text_type_main-medium pb-6\",\"listItem\":\"orderid-list_listItem__1y0NA text text_type_main-default pt-1 pb-1\",\"list\":\"orderid-list_list__2Nt07\",\"itemColor_green\":\"orderid-list_itemColor_green__3zQ8c orderid-list_list__2Nt07\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"input\":\"pages_input__ttxp3 mb-6\",\"button\":\"pages_button__23pFs mt-6 mb-20\",\"helpRedirect\":\"pages_helpRedirect__3CQFO text text_type_main-default\",\"link\":\"pages_link__1KkYQ pl-1 text text_type_main-default\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"ingredients\":\"burger-ingredients_ingredients__3WCxa ml-5 mr-5\",\"title\":\"burger-ingredients_title__3Bmxo text text_type_main-large pt-10 pb-5\",\"ingredient_groups\":\"burger-ingredients_ingredient_groups__1uV5c pt-10\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"ingredients\":\"ingredient-group_ingredients__1WGNS pt-6 mb-2 pl-4\",\"title\":\"ingredient-group_title__2rjbP text text_type_main-medium\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"constructor_total\":\"burger-constructor-total_constructor_total__1l9bo mt-10 text text_type_digits-medium\",\"button_wrapper\":\"burger-constructor-total_button_wrapper__h8HbX ml-10\",\"info_important\":\"burger-constructor-total_info_important__6cwlR text text_type_main-default\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"centeredForm\":\"app-form_centeredForm__2AjJ5\",\"profileForm\":\"app-form_profileForm__2gDfq\",\"title\":\"app-form_title__1PPyZ pb-6 text text_type_main-medium\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"orders\":\"feed-list_orders__3qQZ4 ml-5 mr-5 pr-2\",\"orders__profile\":\"feed-list_orders__profile__RiHiZ feed-list_orders__3qQZ4 ml-5 mr-5 pr-2\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"profileNav\":\"profile_profileNav__2LcJ6 mr-15\",\"profileNavItem\":\"profile_profileNavItem__kOb3f text text_type_main-medium\",\"profileInfo\":\"profile_profileInfo__2XZxm mt-20 text text_type_main-default\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"title\":\"feed_title__1BBPB text text_type_main-large pt-10 pb-5 ml-5 mr-5\",\"contentArea\":\"feed_contentArea__1GtPG\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"header\":\"app-header_header__28JmB\",\"nav\":\"app-header_nav__3HvHD\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"main_nav\":\"nav-list_main_nav__33XRD\",\"nested_nav\":\"nav-list_nested_nav__VXxdO\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"modal\":\"modal_modal__2RPLZ\",\"close_btn\":\"modal_close_btn__zO7Bt mr-10\",\"close_btn_ingredient\":\"modal_close_btn_ingredient__3YzM5 modal_close_btn__zO7Bt mr-10 mt-10\",\"close_btn_order\":\"modal_close_btn_order__2yIJA modal_close_btn__zO7Bt mr-10 mt-15\",\"close_btn_orderInfo\":\"modal_close_btn_orderInfo__2Vsoe modal_close_btn__zO7Bt mr-10 mt-10\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"burgerIngredient\":\"burger-constructor-item_burgerIngredient__G0IIR\",\"dragIcon\":\"burger-constructor-item_dragIcon__Oyde4\",\"dragPreview\":\"burger-constructor-item_dragPreview__1Evvb\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"buttonsArea\":\"profile-settings_buttonsArea__tvk-v\",\"buttonSeparator\":\"profile-settings_buttonSeparator__2m6CN mr-2\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"price\":\"price_price__2rzLo pt-1 pb-1\",\"price_num\":\"price_price_num__3h9Nt pr-1 text text_type_digits-default\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"ingredientContainer\":\"ingredient-icon-round_ingredientContainer__3xYVr\",\"ingredientImg\":\"ingredient-icon-round_ingredientImg__3mktB\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"label\":\"feed-info_label__3eMH- text text_type_main-medium\",\"value\":\"feed-info_value__1hW61 text text_type_digits-large\"};"],"sourceRoot":""}